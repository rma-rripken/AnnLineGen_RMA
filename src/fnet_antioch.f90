module fnet_antioch

! a = 7.1561e-005
! b = 0.16448

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.014073308367,-0.187095188771,0.190126323789,0.110253066457,0.488815510302,-0.556900571194,0.526225942908,-0.306836435369,0.059822823939,0.227127984610,-0.297550740068,-0.341138841765 &
            ,-0.977159944628,0.712946282089,-1.114088233578,0.297017887510,0.219037022359,-0.035404037539,0.282552546774,0.084943548064,0.528993247634,-0.034564662907,0.631449078401,-0.615733878924 &
            ,-1.063192096011,-0.230471342770,-0.277036020234,0.825143764147,0.487291373052,-0.637470181874,0.731742846367,1.740047129835,1.133671475770,0.312399620779,0.105199932386,-1.121719348305 &
            ,-1.439126440741,0.668120915837,-2.028463641322,-1.590584979210,-0.300045928478,-0.404520277072,0.387743499879,0.599855834679,1.221382962903,-0.917969134168,1.641824569587,0.189031899333 &
            ,-0.016842982033,0.110245203268,0.008974453902,0.285884726180,1.659846075681,0.395167750773,1.942738247063,-0.876416269751,0.682999949008,0.277574623085,-0.203362823381,-1.089895104169 &
            ,-2.623073686993,0.388086646374,-3.370036146282,-0.115906845400,-0.481696688074,-0.287596995166,0.271993628091,0.855266579721,1.479487069908,-0.448504993368,1.886202117449,0.231778572805 &
            ,-0.459508946715,-0.189725333253,-0.116044991027,0.338237202559,0.758224191952,-0.440797357784,1.118430877646,0.518254753969,-0.026589030684,0.067360510615,-0.108586590143,-0.053622166403 &
            ,-0.520705931002,0.335455734653,-0.628324060048,0.320208666240,0.100566093293,-0.026547197606,0.063241782131,-0.069060307313,-0.106963742717,-0.078715657203,-0.190542704284,-0.135869130198 &
            ,0.387035708307,0.020840982355,0.155022771614,-0.255268977642,0.035806522123,-0.006723134892,-0.104580536288,-0.847588846150,0.373365239950,0.001392466581,0.187724954274,-0.200700472057 &
            ,0.172432771550,0.009201719396,0.168869480442,-0.706717455258,0.062935068196,-0.022991396168,0.050311093218,-0.023320985138,0.014691887490,-0.095536595198,0.006523554691,-0.027919613341 &
            ,0.020683058967,0.076330352713,-0.039732224313,-0.016074153271,-0.128055311877,0.269105365732,-0.195588138913,-0.130361467453,0.042278053039,0.038278675524,-0.026104578009,-0.042745173318 &
            ,0.397619139512,0.114400664815,0.512722398010,-0.438883789440,-0.275411177384,-0.106877991860,-0.076423665908,0.133462078618,-0.142830014255,-0.304426924013,-0.041364695011,0.647865682587 &
            ,2.586027289388,1.046783391528,0.235364428169,-2.180646462128,-6.240905856372,2.032294278826,-9.268160624357,-2.272694901027,-2.331065027070,-0.088729754265,-1.873403678673,-0.099799982496 &
            ,-0.350977065232,-0.628122281083,1.540222008911,5.436917335628,-1.341569060296,-0.215597350008,-1.808738464077,-1.056874029001,-5.501934298670,-2.293666366409,-4.215275117895,12.317459349875 &
            ,-0.042129586244,-0.412462981563,1.760772276735,2.499337181881,2.252336853055,0.024857136766,0.268816572795,-3.558499686040,-1.384306124721,0.692717187555,-2.358076241220,-1.140337462980 &
            ,-3.572751487886,2.144469260383,-3.541790371512,1.992971882829,3.908249908854,-0.658486729339,2.682785919870,-1.934069318418,4.118644821598,-3.491739808067,3.641183440050,-9.169226688280 &
            ,-4.141483911032,0.716716192093,-3.944497560737,-0.152968427380,-9.164622945629,1.360083600860,-8.681608811900,14.766030348082,1.044696688092,1.479587425215,-1.132511653208,-1.713724769434 &
            ,-4.829619021211,4.041263064256,-6.797642898326,0.053392355913,4.303823127177,-0.616549708212,3.753532769573,-0.933730957469,7.578820752681,-2.715995065069,8.333567731031,-11.493605513740 &
            ,-1.949270546762,0.354803669630,-0.925839440719,0.754635480722,-2.835446969988,1.844628268033,-3.370880176231,4.538609612877,0.269520412505,-0.249695387645,0.601042778796,0.205824065874 &
            ,0.270836297998,-1.154367191671,0.169821475562,-0.222513606116,-0.483642479385,-0.026941911223,-0.262826914908,0.166042955955,0.254299475482,-0.035635060867,0.505865233807,0.244779551361 &
            ,-1.001029240719,0.140392095125,-0.540790415765,0.595170199936,-0.297273206983,0.445490129602,0.291671987947,2.570365477617,-0.643149798652,-0.065659732345,-0.224255859370,0.412385245748 &
            ,0.846996725254,-0.516018395132,1.236445979546,0.534402576583,-0.707511738599,0.259408818794,-0.774673808169,-0.025531077376,-1.198293138446,0.105754988123,-1.340330141640,2.202674902957 &
            ,0.947194998635,0.288839310924,0.309758171722,-0.686304476067,-1.080119575560,0.347311524873,-1.738728614159,-0.989290811898,0.594880247499,0.238642137565,0.294725309985,-0.212425781740 &
            ,0.383585171755,0.211887452349,0.505925473246,-0.235270550498,0.638017596409,0.132978924593,0.178068869548,-0.465597430248,-0.196154104217,-0.826862439888,-0.715287352902,-0.865861579891 &
            ,1.400370394681,0.401067880158,0.443487322119,-0.870577276809,2.871364005336,2.071309085731,3.699659564574,-6.639323879644,-1.130547507785,-1.387875015072,0.515815040889,1.739676454811 &
            ,5.897786041290,-2.929219660613,7.807797892884,0.299260400801,0.689206739510,0.337323872848,0.319944335756,0.275152010890,5.292948229409,1.909491008897,6.399594497321,-6.633385912717 &
            ,-1.159555118242,-0.428788068172,0.183704959209,1.310477034032,5.179318404192,-2.385752566442,7.161344293530,1.302467495356,0.310999564961,0.311447942543,-0.551141472539,-1.353262481574 &
            ,-6.330710455286,0.081512746414,-7.587892535050,1.928893088461,-1.177062544594,-0.609996704751,0.498217125103,1.664211379484,1.560293236561,-2.449191753276,2.184951935172,3.716031904535 &
            ,1.779304607039,0.943337128844,-0.034301029893,-2.154625047136,-3.679992735020,1.824387966465,-4.518893734345,-3.491246086356,0.473704137025,-0.119133633565,0.093654803900,-1.310728184763 &
            ,-5.128568332219,-1.947904123556,-6.199376311038,3.239313727439,-1.797522318885,0.322541305435,-1.358238265708,1.501401979232,2.210895850480,3.245455227095,2.821880051378,-0.190311340078 &
            ,-2.990112417281,-0.422543107191,-0.518540251724,3.573825256809,11.836527002477,-0.035639544685,15.477520148067,0.364066643624,-0.543499857084,-0.348266292831,0.202131715628,1.019967358636 &
            ,3.264980828723,-0.741020327048,4.151899341031,-0.200212530167,-0.280610493797,0.299417609024,-0.584910408659,-0.181882590639,-1.803274259211,0.789541540684,-2.315374553344,1.382338552636 &
            ,-0.726203253979,0.031088716587,-0.532829779988,0.253787251738,-0.565053711171,0.179219166347,-0.320537989111,2.016919940431,-0.238852404759,0.184493732019,-0.835992643090,-0.788837074942 &
            ,-2.106068473750,0.076870826798,-2.129149756437,2.147902311659,0.158675221111,-0.348833146895,0.917771165883,1.044162438512,3.635823639576,-0.217747735795,4.089817052860,-2.533917160502 &
            ,-0.246606113873,-0.356674211620,0.601465016312,0.998314062672,4.809326302209,-0.701087700537,5.949025549788,-3.203489187830,-0.356535967878,0.532029647845,-1.454520549551,-1.477029699749 &
            ,-7.211091047914,0.302606199035,-8.589863460344,5.621221174508,-0.203469315828,0.125177859538,-0.101107525829,0.078146612514,-0.185575870484,-0.156369327516,-0.167340261669,0.762338903876 &
            ,-0.085811265788,0.599583839877,-1.528498209675,-1.018057768353,1.561823866497,0.924659719720,0.438607158328,-0.212948442992,5.992611821661,-0.825244546067,6.066553747565,0.423704763539 &
            ,-2.212312580228,-2.105469606880,-2.611092257828,-0.056073797464,-1.854821109358,-1.774617957591,1.857325020285,3.380848057561,0.337570332862,-2.598790601327,-2.142546773526,-2.102840773263 &
            ,-2.445155160210,1.647593334687,-4.723728014924,-2.739996734631,-2.543262112005,3.042555577763,-0.041036764889,4.508256559715,1.720954855529,0.477564499444,2.145076247756,2.533784679457 &
            ,-0.652789303213,1.377138517722,0.825049257212,0.452582594586,-2.778418572622,-1.684074523602,0.137493524521,1.439896011425,5.188795442846,0.011965958431,2.937053537634,-2.150823253074 &
            ,-5.676399293853,2.687422111953,-9.295105611635,-2.411398200740,0.343988628746,0.199349872505,4.899935656231,-2.980365894271,1.680035917419,-4.626874840462,5.332269930355,-0.358810522963 &
            ,-5.087155602022,-9.894824971961,-6.566080742641,-2.307000958781,10.253072012211,4.509144504938,-1.447414736376,-4.371222321065,-1.192822752993,7.514574303361,-6.789307436298,-2.843069597633 &
            ,-3.631905849469,-4.989911133275,2.724645302036,2.898886206210,0.415048896487,-3.071629368101,4.400561606834,-3.432246670423,-1.371389480206,-0.547699852189,-3.430663647692,2.075352843093 &
            ,8.913253798242,0.549950749196,3.884155557363,0.454523048019,-2.820280631975,-0.570987258635,1.112951809344,3.402902671512,2.612145247054,-0.735030398654,6.181219065312,-1.438127202631 &
            ,-0.520082129286,-1.293220994780,2.039460870463,4.703152696087,1.642934799117,-1.857170642877,3.083627294676,-1.091861565222,-0.031187081551,-1.426041307730,1.005500600003,0.861862403528 &
            ,1.770945941753,-3.105900875237,0.071862868616,-0.011865961646,-0.474353543612,-2.625928805941,-0.860603367089,-1.591705189252,0.408201977437,-4.352087938834,-0.707952047085,-0.396974803722 &
            ,0.001352058395,-1.470842563467,0.419535754281,-0.926311401183,-2.279862644131,-1.682716800254,1.548174055134,-0.119688788013,-0.171709841861,1.323228517756,-1.756470217624,-0.604217885581 &
            ,1.162847108860,1.931398467255,0.235677353020,0.062478036892,0.802533392199,0.971845049501,-0.966895946390,-0.721587359780,3.125419649502,4.606891281061,1.988134823985,-2.780182629367 &
            ,5.059085047654,0.325818085005,3.066605754405,-1.969582359293,-1.181229630320,0.821299416397,-1.224533799197,3.139007160328,-4.144575266254,0.001352015176,-3.059164418342,0.555579937059 &
            ,-3.749625427889,-0.171574692707,-4.166027921871,-5.714590127661,3.081342351593,0.363838166978,1.713848336044,1.766496122486,6.262330496110,-0.698729433398,0.501745266855,-8.557756034985 &
            ,-1.438847875416,-1.420996501125,3.279153700931,5.723422838644,5.238321895188,-0.028537322157,1.159697712022,-7.304599446559,0.882121734634,2.852118740677,-5.183641837491,-5.161264040085 &
            ,4.750721814103,4.606946539939,10.208321846865,-8.033433216610,3.686117131437,-0.820864068270,3.601504446310,3.960763835485,4.807542697773,-3.915505828226,-1.442198467516,-11.821946382216 &
            ,-0.529274009545,-1.569512958147,1.917287213122,6.407516410000,5.822692459085,-0.493747586751,2.683913254911,-14.108533068878,2.341100082312,-2.345446010488,-0.786259260257,-1.130249258442 &
            ,5.818800878401,-7.983750781800,1.843268815427,-19.227679170400,12.288963313159,-5.813019563403,2.169047071531,-5.333660795438,6.572836536534,-17.788498506679,8.134040412738,-7.407786095777 &
            ,-6.931526944602,-11.410834252775,-3.293642965629,12.706816143912,4.574606000048,-5.972161992343,-1.414262890044,-7.693453307804,-0.535061046297,-4.651988953222,0.432984468453,2.286313735276 &
            ,4.330196109258,-1.151088272515,4.842710312459,-4.992416522318,0.327459063449,-1.975135345878,-1.495995643995,-1.902525992055,0.253172683744,1.627187475581,0.421722375273,-2.432193883083 &
            ,-1.195133273866,-1.958166168309,-2.332695325621,-1.648195893854,-4.205055193629,3.341426274310,-2.196080390217,-0.324864210953,-2.345124978625,-1.010401831253,-2.876125519351,-1.409474406590 &
            ,-1.830638818990,0.225644918509,0.113081717120,-1.681963537497,0.013323641388,-2.239530391867,-0.347923648132,2.447678500702,1.752401480564,1.394470638307,-0.526003750320,-0.789125491290 &
            ,0.882393912678,-3.405702117193,4.032231953494,5.296176173006,0.007051085010,-0.294729722455,-1.967828003537,0.036140872057,4.480532199917,0.449741228622,1.447953287806,-3.275580188013 &
            ,-2.224973609801,1.476781035765,-3.313182558950,-4.955259789735,2.658729983828,-1.002802459581,2.363217044288,-0.729950664731,2.877257259374,-7.052950914256,2.414306256013,-1.600915593545 &
            ,-0.401769101660,-0.001660760187,-0.259449916299,0.210841118788,0.951744500032,-0.075669849754,1.070612118174,-0.880334666198,-1.014092258529,0.175576264850,-0.700189953188,0.479927742953 &
            ,-1.549649036796,0.912538582094,-1.161792532744,4.448405651438,0.078821311509,-0.481272019883,0.343969849273,-0.332631693487,-1.038263523220,-1.687641727715,-1.165777460268,0.234847249733 &
            ,1.959232417320,0.553034658735,-0.299823849956,-2.509170678680,-1.654538298896,0.688979185813,-2.131870514682,-2.766785888679,-1.495537542987,-0.391165260992,0.333305782219,2.127078309445 &
            ,0.700128689075,-0.344750190165,1.207837527249,3.876574946377,0.120265280224,-0.316196228027,0.274031626296,-0.212992086833,3.452218279691,-0.623890232830,4.254327787653,-3.662503683148 &
            ,-0.190750234317,0.515850821646,-0.674592901333,-0.490484873287,-2.955471767183,1.057114395516,-2.936062030056,4.362939986391,-0.794534094106,-0.070695835789,-0.031945608108,0.628505689202 &
            ,-0.024076198920,0.192069659941,0.108268377380,0.576663667758,-0.512029790569,0.608652283717,-0.475520993957,-0.192782278492,-1.774876687530,1.719298375871,-2.357098522841,0.853050764280 &
            ,-0.722324919328,0.490687131718,-0.060480205376,0.363540263481,0.607313368344,0.076742645610,1.161689562951,2.265326513135,0.588734141857,0.192033753487,0.213497725644,-0.499589370676 &
            ,-0.319455453061,0.010757500917,-0.468401161081,-1.225201797385,-0.494650732654,0.170484121933,-0.179824898490,0.398988989487,-0.459245998821,0.352950466416,-0.365883766779,1.623349534905 &
            ,-1.033410131756,0.204355196967,-0.670633744144,0.425949750543,0.092957799440,0.044499900941,0.976519750706,2.926835492291,-0.361481818337,0.132834528778,-0.240673525193,0.136638353374 &
            ,0.591911228120,-0.412284556214,0.870937235353,0.396356733961,-0.256400204897,0.357393952890,-0.408872726833,-0.117914721894,-1.002029070624,0.622122320501,-1.268061314552,0.854970196144 &
            ,0.265816090912,-0.022740355297,0.459818410381,0.090636102431,0.905255059963,-0.040684323925,0.787510646880,-1.844176816753,0.542814393716,0.020644143418,0.227357527897,-0.589407346579 &
            ,-0.946374609361,-0.360817842593,-1.209305236770,-0.347942408592,0.840838372778,0.159929833613,0.367177306232,-0.393403561969,0.600009043460,0.937722157229,0.317387318364,-2.303098264356 &
            ,-0.465918306516,0.135813066870,-0.336210590995,0.219091892383,-0.784346213147,0.599944959043,-0.724235587005,1.162311935663,0.471262010971,0.049503355467,0.033521530518,-0.605195045209 &
            ,-1.209230259487,-0.166804368552,-1.693739903701,-0.608444588277,0.039222903464,0.021457855156,0.114634436797,0.098137188233,0.130867560459,-0.188857191889,0.101743270839,-0.135189279493 &
            ,-0.381682952735,0.015678223891,-0.261097267204,0.114399909645,0.294763987701,0.080017545994,0.654662136342,0.677739756365,-0.268245076797,-0.040823057290,-0.006346233742,0.365710679380 &
            ,0.269212587410,-0.069963671478,0.324195335134,0.597323617287,0.200406474647,-0.056188870080,0.167636660406,-0.057161853132,0.332085972630,-0.178534458909,0.314450834174,-0.609962379182 &
            ,0.126010901314,-0.143149279535,0.408179221642,0.347896645547,1.075220360859,0.048493678828,0.974278842388,-1.555151523635,-0.123224571522,0.018526030274,-0.184877963665,-0.124611393101 &
            ,-0.186281529339,-0.153138543805,-0.078449833744,0.291987988476,0.031032403456,-0.026746827212,0.402312081761,0.646659876388,1.131658181736,0.541406599042,1.088659833614,-0.581082605224 &
            ,0.394268043792,-0.020176392815,0.094986148552,-0.476537836448,-0.478952868598,-0.298424748801,-0.658318880283,-0.730793907838,-0.054082405702,-0.013634678029,0.014793634874,0.085296730291 &
            ,0.195255918041,-0.045580381977,0.279685759532,0.092244922846,0.019028046174,-0.040353882135,0.044081321219,0.000545812435,0.020901685347,-0.105213485425,0.036330521054,0.061061960162 &
            ,0.045833356104,-0.001810296284,-0.028587930904,-0.108170586987,0.019467782599,-0.000198878369,0.050799422047,-0.157652284507,0.000711864541,0.019277862573,-0.069948743331,-0.101057338648 &
            ,0.023343456956,0.004512825625,0.075836012256,-0.167160005871,0.005708054693,-0.001126263284,-0.013072070530,-0.035186087393,0.181919329736,-0.024005745622,0.278502981128,-0.201344274667 &
            ,0.026121596209,-0.055248230806,0.132337695845,0.137225353417,0.630694720333,-0.077733484004,0.764783679537,-0.342851303371,0.081362376180,0.000866896886,0.075148407728,0.034181189099 &
            ,0.343612584619,0.111137815426,0.407535792690,-0.284814594104,0.108107403224,-0.070041769238,0.120315430590,-0.024335076156,-0.015411192480,-0.218552616237,-0.072705639998,-0.162344304734 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-2.6905,22.9728 &
            ,12.8139,3.031,4.1974,-23.4359 &
            ,-0.96546,20.3553 &
            ,5.22,-19.8966 &
            ,-4.2731,-12.9558 &
            ,-1.4182,13.2483 &
            ,0.26067,-3.4935 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/5.7963,-7.3547/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/0.25697,4.0195,2.6784,-0.36026,2.5224,6.1644,4.0359,-1.2233/)
real, dimension(2) :: bias2 = &
  (/-13.1063,6.6178/)
real, dimension(1) :: bias3 = &
  (/7.5347/)
contains
subroutine fnet_antioch_initall()
end subroutine fnet_antioch_initall
subroutine fnet_antioch_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_antioch_engine
end module fnet_antioch
