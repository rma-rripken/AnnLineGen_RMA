module fnet_LosVaqueros

! a = 0.00034725
! b = 0.41287

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.184270160507,-0.853364527352,0.016833020331,-0.218893127717,-0.068260112645,0.004781683752,0.122387481459,-0.395154296887,0.048515755292,0.723693965792,-0.004453186879,-0.086613079697 &
            ,0.015951877644,-0.018588936995,-0.040820169300,-0.046786286578,0.075067860257,-0.318923293782,0.009129962623,0.348139369565,0.036075360284,-0.000403169314,0.001408687133,0.290648481720 &
            ,0.364640285346,0.238195554724,-0.006519926641,-0.041133378778,0.191868614758,-0.077825870285,-0.070663372340,-0.036036469156,1.023363512949,1.108917570102,-0.018531018697,-0.111704417450 &
            ,-0.273942760001,0.120980584069,-0.103767020730,-0.063604857238,2.310840852961,-1.319379514901,0.030127359315,0.402086119861,-0.089601004657,0.059993265512,0.016467947819,0.060069787376 &
            ,-0.553984812724,-0.312374031702,0.023626795496,0.203158104739,0.016171105157,0.036397806025,0.073093586781,0.140183061010,-0.247052704543,-3.014264099513,-0.000764171319,-1.149383849031 &
            ,-0.178925679013,0.062171287965,0.046965310284,-0.737085672016,1.434502050359,2.917495686039,0.033678465574,1.046301422968,-0.081253183580,0.018181481377,0.051218707649,0.492657117598 &
            ,-0.242961109513,-2.035032199175,-0.006842054413,0.233114703737,0.612711648692,-0.354162689781,0.065688794665,0.252334750218,-0.222723299390,-0.463062993934,0.001607079664,-0.038902183294 &
            ,-0.002368610176,-0.005021308772,0.025889505693,-0.034274242800,-0.361104786195,-0.093025222741,0.002496883637,-0.107507329666,-0.031849888825,0.015619053886,0.033797433444,-0.059942892029 &
            ,-0.168179056282,0.130990291749,0.001304322801,-0.200360214570,-0.027576997921,0.027185155891,-0.005942406200,-0.111776563052,-0.319844953098,-0.297865164662,-0.001874660730,-0.038229502474 &
            ,-0.035320755765,0.022893528429,-0.003958527212,-0.030202206195,0.051972006221,0.112583009512,0.001432786407,0.015162095810,-0.035103245655,0.029396300679,-0.010360920030,-0.006234577165 &
            ,-0.205192460824,1.160421602135,-0.002013490832,-0.052452039282,-0.047122791953,0.033258339636,0.001443555620,0.096918254746,0.188086817630,2.589096178566,0.001402794503,0.179194286120 &
            ,-0.011557727776,0.019865641554,-0.025670889142,0.125925088411,0.161981745389,3.027735968937,0.002303452016,0.276239765873,-0.138097511965,0.064829684631,0.000853888170,0.095810298939 &
            ,0.090116330720,-3.599160489807,0.158851257325,1.163810837138,-1.582463642373,1.270210283075,0.322100743504,0.358428406391,-0.791092252957,-2.266484137763,-0.028769554815,-1.924555946451 &
            ,0.766155063507,-0.351519139131,0.101889508582,-0.460550999095,-0.112933286172,-3.169770696192,0.096841181552,-0.435932342369,-1.420046040283,0.868992986868,0.208555705021,-1.231264442492 &
            ,-0.353025623060,-4.311932927347,0.089810923622,-0.081471262509,0.926343431292,-0.503931725664,0.468953139794,-0.090757693891,-1.274728037907,-1.995637985926,-0.009494729034,-2.384011666256 &
            ,-0.699587736279,0.529306646802,0.330630533074,-0.949733558388,-0.308369092198,-3.508191304493,-0.071325927701,-1.603078431406,-1.897795656874,1.099536069658,0.150612476170,-0.740351067910 &
            ,-0.765816859026,-0.500550532646,0.104357518120,-0.246874673391,-2.093998502185,1.145891834910,0.915529638792,-0.799253421926,-0.892315572553,0.466487233852,-0.228342697282,1.085917109706 &
            ,1.821692453367,-1.159141522202,0.491334909703,1.809890845726,-0.127990009397,0.721700376506,-0.198921273913,1.707911466757,0.572662315859,-0.520885240412,0.397898534614,1.004673552425 &
            ,-0.848234117644,-2.341820168078,-0.078625546361,0.392618727541,0.261559577074,-0.343128457197,0.743530234729,1.006852716133,0.500919427909,-0.306089017269,-0.054989450724,-0.686548758134 &
            ,0.459878726138,-0.290427288786,-0.074478240627,0.277042244522,0.592125308353,-0.940361353193,-0.025411546640,0.305520173115,0.348484229579,-0.218856718639,-0.040912671518,0.235916727103 &
            ,0.127614347809,0.612554902265,-0.012758387554,-0.188605079711,0.325810256361,-0.193803505822,-0.035756231987,0.348366062227,-0.179674586877,1.318803751221,-0.019962281631,-1.149279902550 &
            ,0.204844507780,-0.172119274559,0.065167262815,-0.310190275620,-0.017167657510,-0.036954270393,0.016032063372,-1.087424386812,0.047253996613,-0.108477994767,0.232909852258,-0.495325164033 &
            ,0.327013550583,-0.498116151819,-0.002212426672,0.024190695001,0.138024752869,-0.099946739001,-0.002194967536,-0.062458535287,-0.539962389792,-0.891047315702,0.026048901916,-0.601917326821 &
            ,0.124264956897,-0.107729903054,0.211893133324,-0.225012716441,-1.370200214390,0.289093172380,0.048556787802,-0.944867498234,0.799182724884,-0.576639151508,0.458373475604,-0.740888940159 &
            ,1.961682070742,7.729585815643,0.020034634825,0.582225469087,-0.751045744764,0.423371659298,-0.171147966866,0.325227826349,3.816618231225,3.093698092695,0.053210051857,1.297572351452 &
            ,-0.983977240474,0.473579515431,-0.268964463004,0.511249220733,2.461796653204,6.528821758814,0.020887631209,-0.304892524460,-0.328061021308,-0.105134421257,-0.201354888887,-1.049736958875 &
            ,0.101290190364,8.872659258619,0.129496630405,-0.377785262424,-0.623933442608,0.128285884723,0.443422546024,-0.561002208559,0.021185128407,-0.179917335983,0.039949540944,-1.430810400673 &
            ,0.615749415715,-0.527564008941,0.227413392599,-1.670382851445,-3.344570559332,1.318238847180,0.068226975098,-1.683423450928,0.206706378680,-0.019661727099,0.582010323799,-0.728466230170 &
            ,-1.969613023661,0.651216294898,0.005603910077,-1.081983651220,-0.200537386906,0.392096898664,0.114171763357,-0.534410835661,-0.966610597370,-6.070438961082,0.069425572085,0.450948923387 &
            ,-0.668925596862,0.835554863796,0.211988317197,0.511215051001,3.013456782914,-4.150222456376,-0.104643497298,1.838726493671,-0.680711068488,0.325033002126,-0.842595288895,0.641361533380 &
            ,2.804120025574,5.913679603495,-0.024140807741,2.860179735888,-1.228390411488,0.528186253086,-0.535567660104,1.677108061382,0.394248631057,0.714004397137,-0.024841842907,0.506437469681 &
            ,-0.056209392026,0.051812363839,-0.166602532368,0.459720724879,0.522372816278,-1.896354019846,-0.004094991280,0.067805658864,0.037002603741,-0.047205227219,-0.053666124198,-0.142714621992 &
            ,0.473379695292,-0.604319232001,-0.022213293170,0.394820215920,-0.140529922947,0.020186659165,-0.106184745617,0.136491158204,0.419342975350,-2.705120051754,-0.019626193140,-0.050989084323 &
            ,-0.179967624568,0.083127566785,-0.151474587276,-0.164890520276,0.620892522638,3.871990952005,-0.024285345921,0.662064273973,0.085740721035,-0.090875971158,-0.123717180393,0.718542900990 &
            ,0.822452422273,4.256794307827,-0.030845537472,0.728418138297,-0.120630259355,0.009833366745,-0.214465260637,0.605376110308,-0.432516266720,-6.954442256690,0.029718107727,-1.091996947673 &
            ,0.094151849162,-0.001041818228,0.090596284719,-1.110929401324,1.145804269555,-0.874537818202,-0.007832912967,1.259322456926,-0.115268657271,0.057105207236,-0.085284055888,0.717306154237 &
            ,-4.484073995722,1.745762085500,0.150747698962,2.184484391866,4.258292235118,-1.346868036582,2.030956275931,-1.150932671845,4.941341641787,1.286003635928,0.374909830916,1.637244244654 &
            ,-1.580390983411,0.184301376746,-1.430220446644,-1.070889737928,0.295390782401,1.208737186149,0.077101103473,-0.970571390608,4.095959945504,-0.769388601358,0.355614255562,0.718725911165 &
            ,-0.822786234134,1.578694276362,-0.565570797582,-2.124290723260,1.516106756481,-2.809518304725,0.913942100525,-0.378001111773,0.177649694290,1.246799275293,0.071653701398,3.291253882764 &
            ,0.693385447951,-3.766991227921,-0.062212841627,-3.566126742434,-2.550122805592,0.686174745692,0.500266370570,2.105211730420,3.487755537473,-3.059666911365,2.413585652256,-1.695077390569 &
            ,-4.323024527463,0.946088460118,1.656190686131,-1.345681802269,5.694346286299,-2.336976983667,2.406261713543,1.732476649570,3.924344550284,-0.687678978063,0.039064482119,-1.368369771881 &
            ,-0.530282566663,-1.701537234119,-2.775256667168,-3.024111100474,5.584657399552,0.605185551691,1.818491918820,-1.974627599051,2.308661517068,0.282535428015,-3.179730026094,-2.430880456053 &
            ,3.445239505543,-0.443133524741,1.856397233485,-3.567765189909,3.574873372568,0.943046246218,-2.005980570336,-4.819367368280,1.342599546459,0.167806643196,-0.120528536959,1.982278689497 &
            ,-1.028627221269,0.049159087827,-0.395803898049,-2.341249301320,0.227281204286,0.591545928743,0.428381194485,-1.166482030045,-0.404344953397,0.516875082892,1.221077381383,-1.319947839842 &
            ,-0.060630909029,0.013209053190,0.390818604533,0.057984225773,-1.576675631066,1.602350212712,-0.862631190785,-0.965085734627,-0.684156605698,-0.072311831275,-0.184527450467,-2.798674828462 &
            ,-0.880629924321,0.719597419893,-0.986665174780,-0.798976271922,0.551466627153,0.418658928553,0.083949385930,-4.441098459081,-1.506685446420,0.231478350991,-0.753721921952,-0.430315620357 &
            ,0.578128430587,0.801567549508,-0.304555390837,-2.768009354482,-1.002218347688,1.623151594161,-0.980405561991,-1.211456059488,1.674980004774,0.952631194511,1.141016773288,-2.774991879336 &
            ,-1.028637349479,1.517056142163,-0.542000425287,-0.765629368787,1.303283543079,1.199190691469,-0.708969521762,-1.297687179790,0.477124934326,-0.558437291503,-1.400646696798,0.364086368218 &
            ,1.395935356693,-2.174566781709,0.104746617752,0.979727716568,-1.978928780701,0.086073594473,-0.758934891932,0.955975943545,-0.947021723115,-2.357107024650,0.145145605564,-2.196282101553 &
            ,0.701398716107,-1.096459673223,-0.183506909667,1.278246894775,0.296417293352,-0.510235191905,-0.197981449585,-0.388238574497,-5.137918616297,0.890097051347,-0.412985317292,-1.920136318182 &
            ,0.164652764497,-0.385495255372,0.409153984535,1.023529183328,-3.568107864187,-0.016280582917,0.051296303032,-2.277619179319,0.618489169420,0.112384728346,0.286821202175,-2.973809555683 &
            ,-5.269231098543,-0.163133498456,-1.215498085702,4.368864416157,-0.484926955801,0.906776465067,3.505268858466,-2.250702190994,3.664100960956,0.988611449964,-0.094064855430,2.080625847596 &
            ,1.405505857430,1.220857867821,2.993464190992,1.217920067319,-4.458464399216,1.378758381369,-0.157770745797,1.305156529224,-2.737890812812,1.230115282793,3.387385230037,-0.342974189925 &
            ,-8.652879694806,-0.331805069167,0.661935841437,-1.957694392566,-2.324991680072,2.414658948255,10.904084286281,1.179244688678,18.797634286248,-0.490599057124,1.760724537748,0.864228377367 &
            ,-1.678730957481,2.489886911982,4.596073844976,1.736959198135,8.080518775649,-0.540426325108,1.778909828377,2.277920885184,0.885651748351,2.898277792161,0.125694325089,-1.030056367998 &
            ,0.310972599374,0.194439313511,-0.373494395735,0.621587809883,0.403429037902,3.214508610286,0.171681510787,-0.038385109180,0.669335820370,-0.053973317595,-0.353862930363,0.584247802378 &
            ,0.223500260785,3.807177411529,0.129363042914,0.244639201846,0.683476173553,-0.148713204046,-0.128817994461,1.205616141115,1.105582041181,3.112160784752,0.061263134985,-0.660106724645 &
            ,0.633121197083,-0.091034472023,-0.258478256666,0.117584344737,-0.034845878960,2.747796300038,0.100973932069,-1.410902249243,-0.252804938515,0.502369314469,-0.132552836702,1.917281826196 &
            ,0.713387998976,2.787280023429,0.048259502732,0.689693972422,-0.312887089328,0.243744277726,-0.024503586065,-0.338263618082,-0.283490286343,2.978965293048,0.019632219955,-0.760342539832 &
            ,-0.156634118876,0.005031150122,0.307198875232,-0.404160351186,-0.704993416762,2.760023415981,0.023241578698,-0.073582715657,0.720641313479,-0.306302423704,0.049239751857,-0.422104091733 &
            ,-0.368760678930,3.490317053953,0.089143105489,-0.299002315260,-0.307575198576,0.250119342101,0.289663788875,-0.414209943367,0.726408701318,-1.366912219993,-0.037856563064,0.396842426309 &
            ,0.318650508476,-0.085509953750,-0.102293187501,0.504826239320,0.574483523863,-3.316787007417,0.065216640736,0.350804684921,0.138697836111,0.001364557072,0.116496858950,-0.593162434413 &
            ,-1.100329922973,1.594912898487,0.004207886537,0.420978659321,0.504727981689,-0.327895510870,0.317835022369,0.298660603399,-1.283440503956,1.367467466343,-0.073990979083,-0.779131345900 &
            ,-0.026801562444,0.222957783413,0.103954783785,-0.091951932538,0.392946654474,3.221893259060,-0.150374854803,0.468786751973,-0.681433930636,0.281438749465,-0.148532600981,-0.270237096739 &
            ,-0.588922762450,-0.942388479888,-0.196751716921,-0.840110356670,0.569608527218,-0.319596126111,0.047240204558,-0.494470437688,2.006352616623,-3.294744838600,-0.188976631705,2.205960645396 &
            ,0.565037758557,0.167576038166,-0.186463382443,1.491196609179,0.850292942417,-2.321224342538,-0.609052707803,1.709141898562,-1.115108312751,0.176068887536,0.249007761608,1.930335585829 &
            ,1.230891819949,2.742918655613,-0.488406126893,0.420277569245,0.801448123654,-0.753951418172,-0.389588905835,2.668164616693,-0.133855959791,2.626665548582,-0.028806121806,0.057407018321 &
            ,0.451437555251,-0.285936538480,0.033432544934,0.633663538504,0.166065898619,0.967433506837,-0.030877404067,0.316026951048,0.228183343134,-0.156848544854,-0.019302193092,0.613733239210 &
            ,0.042293767973,1.756102766419,-0.025381156814,-0.066298402831,0.075076400688,-0.079342790107,0.005229713489,0.516722988789,-0.237090309941,1.870277815553,-0.007390566277,-0.160339169316 &
            ,0.114681964973,-0.155133990490,0.210721719296,0.212271423146,0.084381796333,1.711511194037,0.017117557446,0.447902944763,0.097035624169,-0.137217888347,0.301227894902,0.438704080465 &
            ,-0.061237103101,2.364080613051,-0.002343463588,0.484491787141,0.445105538093,-0.335179335709,0.253882778022,0.651157149824,-0.801668286435,2.465394743015,0.003989711353,1.345168362893 &
            ,0.547630427767,-0.425238480639,0.376624353715,1.327148075456,0.533190092666,-0.234295344314,0.002463315648,0.859774313415,0.683833430895,-0.499883930241,0.291749707249,0.578119541106 &
            ,-0.840124210095,0.278036829879,0.002619081420,-0.707883457472,-0.360687344901,0.120288213529,0.225320436552,-0.718746665940,-0.791415264769,-5.369793349821,0.029246110518,-0.596401594088 &
            ,0.024876294113,-0.018712344400,0.168672156071,-0.700816708268,-0.415121074596,-0.171391717867,0.001531111123,-0.211570292710,-0.196765112727,0.140417445079,-0.005728782991,-0.241623244479 &
            ,-0.318467822794,-0.841368909986,-0.001286785127,0.114762520598,-0.092574183518,0.076059358682,-0.000799431950,0.318703595834,0.796704694259,0.236010109959,0.003003559257,-0.172992968373 &
            ,0.068177774439,-0.064264538386,0.040479772730,-0.194940756094,0.476387007151,0.160044131298,-0.003199788309,-0.489129653473,0.246150525005,-0.159825698715,0.030075650142,-0.169741238113 &
            ,0.322080218567,-0.238452623645,-0.024369682461,-0.392362272910,0.095404363271,-0.109936481187,-0.075474323258,-0.240883622672,-0.007218524220,0.498769107960,-0.001673163652,-0.434149180902 &
            ,0.208907685085,-0.075989104611,-0.214400209353,-0.187643866385,0.032835845928,2.023671781114,-0.004931870909,0.024250203608,0.631047802155,-0.467888301944,-0.004100956065,0.130406527930 &
            ,-0.524973538935,1.137080092874,0.016714245517,-0.387080985556,1.570240889347,-1.152986937406,0.241126575675,-0.192651517787,-0.149458702197,0.411129276687,0.009807238368,-0.240676506425 &
            ,-0.039809563537,-0.002562103130,0.056646425306,-0.183161160722,-0.111801421725,-0.025338629191,0.006394522787,0.060797921817,0.169905042007,-0.112327751529,0.051671241829,0.066251365779 &
            ,-0.090730189582,-0.089606061976,0.004089695482,0.031818013311,0.141152024998,-0.098849352876,0.038701916915,-0.000408339710,-0.074755129825,0.071235397002,0.002413488785,0.021207193034 &
            ,0.083607235257,-0.055996878636,0.008373122236,-0.014786749796,0.006162305965,-0.146780418155,-0.000344730125,-0.015319351805,0.037132343251,-0.014561522316,-0.014606853237,-0.027389103281 &
            ,-0.001424605062,-0.313905874638,-0.004018123194,0.048075974399,0.255281670400,-0.161617035409,0.018289062138,0.058229344227,-0.009189733988,0.085517813972,-0.010792763141,-0.041921439766 &
            ,0.130240471754,-0.102653051963,0.002047513964,0.012527545097,0.145423112216,-0.274226249987,-0.013268764398,0.157593642268,0.206923026923,-0.153704854682,-0.019937010151,0.081154536018 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/5.7552,2.6319 &
            ,7.0314,2.5397,-33.2573,0.14202 &
            ,-0.20506,-8.0955 &
            ,10.2436,-0.3158 &
            ,17.6957,-0.54042 &
            ,20.496,4.0526 &
            ,-1.7203,3.5021 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.4833,-4.7714/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-9.2435,7.0569,-2.3862,7.5594,-0.62794,0.008821,-1.0172,2.4132/)
real, dimension(2) :: bias2 = &
  (/-14.3105,2.635/)
real, dimension(1) :: bias3 = &
  (/5.205/)
contains
subroutine fnet_LosVaqueros_initall()
end subroutine fnet_LosVaqueros_initall
subroutine fnet_LosVaqueros_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_LosVaqueros_engine
end module fnet_LosVaqueros
