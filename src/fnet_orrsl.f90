module fnet_ORRSL

! a = 0.00030801
! b = 0.37752

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.072111253608,0.161081339156,-0.084056330769,0.007309211674,-0.065903227770,0.087226033393,0.067429698045,0.033881995200,-0.059371646987,0.014543929855,0.137294887681,0.024598630218 &
            ,0.063683642897,-0.044052121517,-0.102245802660,-0.149325714323,-0.149357608119,-0.259069371551,0.019635607086,0.003168575580,0.134748893329,0.146173380188,-0.095213057930,0.054911237367 &
            ,-0.168398153630,-0.026263481431,0.037963894572,-0.003461411231,0.177916674814,0.022510377853,0.142475430262,0.122980362117,0.448177067293,0.517472999658,0.081934967856,0.020552827002 &
            ,-0.433077204979,-0.075894168417,-0.004173102538,-0.167194689402,-0.306947935153,-0.268033195797,-0.105059343559,-0.024670936110,0.297591187913,0.048433568722,-0.096264820467,-0.027006987044 &
            ,-0.170797527455,-0.329373519059,-0.024344931324,-0.010979327385,0.153523318428,0.300854062396,0.193130657505,0.359221207834,0.632392164282,0.514681338953,-0.013506680289,-0.022120454386 &
            ,-0.611479465266,-0.300663339350,0.168668227352,-0.137479925451,-1.418483595311,-1.388562040581,0.007213650745,0.007986477375,1.391264447667,0.626798951849,-0.091390037936,0.218820531998 &
            ,0.700704941171,0.816773291696,-0.077833193093,-0.045288315493,-0.685055618884,-0.397497505181,0.080371374670,-0.047362887174,-0.090359196037,-0.250104598386,0.029266327617,0.013377971829 &
            ,0.089146299166,0.051417848789,-0.000931507036,-0.020009577294,0.070767690220,-0.044272469621,0.018185835934,0.000033003305,-0.067314724890,-0.105832381490,-0.080987407576,-0.120179966928 &
            ,-0.035632335600,-0.048607273698,0.017400663692,0.005444052404,0.033892470422,-0.003031112075,-0.018291530243,-0.029580364114,-0.119838230276,0.332509361457,0.038809581264,-0.001618690917 &
            ,0.130490230617,0.048106776478,-0.000133827206,0.040245854923,-0.049666833295,-3.523160159098,-0.068597946245,0.011673125254,0.025833197360,-0.019706142613,-0.002996179900,-0.117024822963 &
            ,-0.193295169790,-0.135220188964,-0.011819402915,-0.005876035611,0.194772565129,0.039589245096,0.029342658876,0.061219084013,-0.198778504848,-0.416604946993,-0.021059143968,-0.000890763276 &
            ,0.188793135901,-0.005460573839,-0.079542750209,-0.057550518803,0.131817837974,-0.389028334377,-0.021461031488,-0.003961103825,-0.124445971399,-0.002601043002,0.188805071031,0.077602624980 &
            ,-2.218105840871,-1.286612748485,-1.179122052159,-0.083073684834,2.102832949763,0.737364960669,-1.008127941937,-0.232694346871,0.360712903602,-1.407266580998,-0.143166353831,-0.111107679252 &
            ,-0.406598250321,-0.555079770884,0.041686547991,-0.047794718711,-1.390670818296,0.115132604192,0.331828657073,-0.140070198657,1.508363387946,-2.864067667119,-0.014050251989,-1.432126262454 &
            ,-0.216941381744,-0.034124925165,-0.509203759583,-0.308369813591,0.220201125384,-0.383422837025,-0.016947305978,0.591188593447,-0.672463623738,-1.223219081627,-1.085154239761,-0.229918141951 &
            ,0.626303027506,-0.140813902009,1.164450385145,1.616694882965,-2.968799409058,-1.369469774690,-0.439491755114,0.061669426180,2.921127357074,0.019731125872,-0.822999243501,-0.536388571364 &
            ,0.961203906848,1.854310017404,-1.527497857140,0.106629095748,-0.796147811647,0.335326834373,0.544618274049,-0.312942750208,-0.945701501511,-5.704063591545,-0.450159807050,-0.036266856649 &
            ,0.814408817578,-0.122148651310,0.606328672322,1.463215508980,-4.682059411080,-4.101813577221,-0.070906175774,0.730818249146,4.496819343347,1.834124910053,-0.223792961711,1.066771615175 &
            ,0.245667885794,-0.837271244553,-0.047950696185,0.539655167154,-0.352043629275,0.756387803743,1.129517455555,0.870755408419,0.702190847538,-0.269652536350,0.192317318767,0.066179822996 &
            ,-0.739861510094,-0.392461080991,0.020816016579,-0.116085497831,-0.333121802698,0.014304803563,0.130498989541,0.020928850928,0.334421493686,-0.321929401548,0.134742738272,0.053168476521 &
            ,0.398849642071,0.297768958182,0.143024982671,0.071204740942,-0.363378264658,0.231403327088,0.468381743831,0.447792760957,-0.313028286034,-0.176060501687,0.098426766742,0.032970481585 &
            ,0.321440059990,0.241655020359,0.332166116276,0.368399912803,-0.428450403435,-1.516225193226,0.152391642555,-0.028118613301,0.377745631027,0.064398711861,0.089032272862,0.289950430286 &
            ,-0.250160618429,-0.180220856441,0.359004127980,-0.079096700700,0.277542920195,0.046230818102,0.418020724526,0.753777436283,-0.084874738790,0.101613833340,0.189718755711,-0.031086313492 &
            ,0.120480847589,0.489842578724,0.518160787262,0.780067073537,0.689119936510,0.978999719258,0.477003467979,0.029674949322,-0.641282759827,0.673092142183,0.742053125515,1.237506443910 &
            ,-3.431253602695,-2.582280616438,0.746503758938,0.174390947848,3.415210444822,1.932332675437,0.277608908207,1.198952321372,-0.951464730675,-2.716120215680,0.523106647638,0.191105886607 &
            ,0.776811751344,0.096315261879,0.162162775338,-0.376668403591,-1.818546627241,-2.522659798390,0.955360543075,0.485376892195,1.624243976303,3.253719885851,-0.204188828453,0.629253670471 &
            ,-1.687493622385,-3.883062759620,0.522421381536,0.121949622843,1.554628389677,0.923168649850,0.072152922020,-0.122570916707,2.471398047973,1.277924666162,-0.045575105356,0.220459350498 &
            ,-2.434715966438,1.881339799317,-0.162009279145,-0.167559527877,1.997889544274,1.437997278579,-0.443322736204,-0.129905302324,-1.877491888760,-0.433402589267,-0.376278671595,-0.539901260971 &
            ,-0.184167298686,1.730020822442,-0.370590163661,-0.127593101739,0.431940551298,0.607525836522,-0.285527562802,0.491711661401,0.961815042910,0.828725551025,-1.008214701963,-0.288647994126 &
            ,-0.695812006556,-1.089929943845,0.159895105279,-0.332689141151,-2.288510833792,0.427529422921,-0.130505005959,-0.045900105990,2.225316736896,-1.155086663296,-1.621349492249,-1.855598956017 &
            ,-7.948628704235,-5.251790948450,0.759644037435,-0.136278154314,7.781772056566,-1.528296090031,-1.344557892073,-1.401615644615,-0.911988123677,-0.166888726232,0.009851345923,-0.001308331522 &
            ,0.881924050094,-0.218728537782,-0.200276565676,-0.132289235762,0.884769691600,0.438254891546,0.048000361425,0.030309379466,-0.927525864380,-0.231904053314,-0.162251320379,-0.318051631176 &
            ,-1.967736297398,-1.407859634720,-0.035108047293,-0.023660663416,1.964768116274,-0.365745233351,-0.181566327972,-0.350115513692,2.635831007924,2.026644293223,-0.012065613772,0.054510936137 &
            ,-2.677169113494,-0.363451230826,-0.169732042593,-0.464026674079,-2.474122484511,-1.495680160722,0.141592311070,-0.012599281340,2.453904731375,-0.095955698788,-0.241896088909,-0.087165841030 &
            ,-2.966319224729,-1.897260027041,0.225559926240,-0.032834000737,2.968693393442,-0.075268676021,-0.061215661764,0.037635177374,4.870138907763,3.533909753239,-0.199802417218,0.124334624696 &
            ,-4.921062960733,0.275817515916,0.041789604587,-0.129748302052,-1.559698942501,-1.303308582715,0.008224341437,-0.095914415838,1.576922832389,-0.909367626809,-0.074996829248,-0.402263872270 &
            ,2.470601534373,-3.552187727857,-2.141840633312,0.040656715681,-2.865286982839,1.390621599003,2.833490441704,3.107686583799,-3.924522177327,4.279264543758,5.683193231300,0.058041832227 &
            ,4.616371998138,-2.372401108268,-2.224601030522,-3.389048589416,0.376450156213,-3.835821466399,-0.479848196740,-0.347805634556,-0.623345266830,2.193261376289,0.283483575847,1.164840366655 &
            ,1.466045583622,-3.899042751061,-2.342011832163,-1.299816645647,-1.619672468963,-8.760049712038,1.811983571582,0.831201374445,-2.911589992526,-2.422667480416,6.934315796996,1.897781877123 &
            ,2.791208226516,3.636195640989,-0.242439044854,-3.329127280929,1.453902777552,3.308503709084,8.890076619078,0.377645614849,-1.541931762402,1.386912133916,0.131859645289,1.453837821311 &
            ,0.594144262758,-10.407141024165,4.056870235249,-1.103151325164,-0.259731540493,2.366211678376,4.356031755371,3.559351294928,-0.408712384834,-0.342565034085,9.333653601711,-2.094325321314 &
            ,1.246496503239,-5.015687637464,-0.874555086685,-2.044087131928,-1.905232244588,7.299302223832,1.704677027924,-2.900397172618,2.675541784388,8.193830997667,-1.164928834912,1.755844794689 &
            ,-4.206459185429,4.505059157587,-0.969116333166,-5.441618510764,5.601904002052,0.789964528300,-0.464047223045,-0.892388692176,1.530622074224,2.791778363619,0.990518730026,0.205038199832 &
            ,-0.929275665576,3.363512234678,-0.347799610599,2.269092411536,-1.077977700738,7.930101338376,1.376649924676,0.410061854510,-0.073270481763,1.634696528132,0.428937333454,0.312716657802 &
            ,1.930379219852,6.980774395611,1.406537242997,-0.649524751482,0.281836450230,0.135091146005,-0.954191791964,1.325249590330,0.928962190212,2.349715285292,0.862063803964,-0.401797548554 &
            ,-2.031179293266,-1.124831876102,0.677247668212,0.566331397528,1.322390372965,2.175621752196,0.884973132063,0.106418204150,-0.223705973027,0.105667840981,-1.614525720053,-1.409696601541 &
            ,1.151721839698,4.058863974630,-0.031284281171,0.083617727362,-2.452416798664,0.734057546510,0.629362271592,1.167340778323,2.708719429730,3.179920170772,2.567861971957,-2.177517915013 &
            ,-1.636599830864,0.097561696532,-0.089352323716,5.969832715599,-4.422949537488,1.415306812198,1.212310850972,1.154252737072,4.740019813610,-2.495770769181,-0.897869668151,-5.238676751187 &
            ,0.590430612204,5.120417781422,6.736597295120,0.595200941623,-0.615889569357,0.269591345457,-1.736487668377,-2.516846441379,1.931800959822,-3.518799369161,4.192602885070,-0.354686447309 &
            ,-2.209534712374,-1.535670106696,1.236176584503,1.295915019019,-1.166355658695,1.216488206580,3.157592129191,-0.397951228027,1.750238273983,-2.615462390414,2.103518839730,-0.844439577897 &
            ,0.828147035296,2.924564072074,7.552487747772,0.373193166828,-0.936807020684,1.861657638492,-1.701493252264,-1.897843512864,0.836285081607,3.209107608425,24.480722852457,0.662764569607 &
            ,-1.234298037926,2.826753967569,0.067794309550,2.109836783310,-2.709284653752,-2.786205577495,20.411263318205,-3.027186107657,2.875925817441,-10.327881135202,0.423593731019,-0.057376031797 &
            ,1.269347109506,5.471038167567,34.790662014062,-3.174560725728,-1.351592153347,-10.384851304686,-1.203679505168,-2.058460393716,-0.687174411915,-3.353520139732,34.076054307864,-6.330480188342 &
            ,0.096380363781,-9.891944501083,0.511795094103,1.805894218589,-3.977729830898,-4.904143305470,6.932427352761,-15.719792687984,4.251586533435,-1.668507070130,0.357110697424,-0.412468423263 &
            ,2.174902113370,-2.207803192996,5.356483620657,-15.497880272739,-2.580063686926,-27.935044942801,0.424284272391,-0.497382159972,-1.859435011956,-0.552047673786,0.775194063710,-1.906895614571 &
            ,2.235035882590,-6.787444900351,-0.056894586290,0.169840674612,-0.137130168868,-0.279745673979,0.370454130550,-0.958939092066,0.222507163585,-1.544229054889,-0.141411108657,-0.463574048380 &
            ,0.371147570022,-0.751472857718,0.146753170252,-0.256122874108,-0.405083263968,0.092199525336,0.252541976050,0.273256125508,-1.197700711516,-0.356593260577,0.664535273033,-0.479332435759 &
            ,1.201219246668,-0.277625012375,0.153801990722,0.832731981179,0.519233598973,-2.616466929004,0.354733977027,-0.494642090665,-0.727483400463,-1.258936526502,0.194845516847,0.977727718204 &
            ,-2.859352215258,-0.280638777904,1.455050497577,-1.052921193589,3.055188528517,-2.305409906624,0.835073414373,2.264520027213,-0.977570213771,0.053178169076,0.922661719644,-0.481739427226 &
            ,1.034519593869,-1.373794128266,0.320233889363,1.075156578538,2.052787231344,0.134065359891,-1.964775809753,0.343794583575,-2.295360102383,1.522170358833,0.356755018279,-0.256007155928 &
            ,-0.858421779813,-1.877222904812,-1.140550089527,-0.099170273263,0.845702422946,0.270387196774,-0.050065374384,-0.342533767348,-0.422393140240,0.638778549469,-0.332173193559,-0.215988774801 &
            ,0.446457485791,-0.897316348896,0.422854962984,0.418078202645,1.362655408228,0.829079256818,-0.592104971355,0.124174945520,-1.395647652563,0.469831483093,-0.196975605140,-0.564146109222 &
            ,-0.655850516158,-0.896945253813,-0.272648868083,-0.003344783712,0.687208074665,0.768218897675,0.187015690648,0.753730464904,0.004827418284,-0.641668367001,-0.871962917693,-0.029110896044 &
            ,0.002443146170,-0.475348351385,-0.037351125865,-0.099442830272,0.668689021033,0.647992875649,-1.879793036992,0.132047073914,-0.636265905003,0.155856432728,-0.195439693460,-0.912242841956 &
            ,0.259500840513,-0.173434601621,-1.845483011686,0.290740016552,-0.294413582325,1.385602516811,-0.027571143884,0.336194814683,-2.747768701970,-1.629518577784,-1.746493051772,0.325925736547 &
            ,2.669418633745,1.076944255987,-0.299960608919,0.747057588559,-0.513107403054,-0.069017172666,-1.209984694438,0.847945583260,0.467367589176,-0.390861839466,-0.222192306120,-0.253337327084 &
            ,-1.224976473500,-2.316832300733,-0.523042309472,0.981407190958,1.010298745284,0.054890651781,0.274177686429,-0.047353796803,-0.399314803598,-0.980962548184,0.027111218242,0.110639103047 &
            ,0.324564909684,0.103059259594,0.172813961676,0.119393283099,-0.633220069525,-1.528228739563,0.136570190042,0.087328577368,0.588388039675,0.239104039149,0.288401230353,0.317654333528 &
            ,-0.207478150052,-0.224508041144,0.027886415781,0.038921285545,0.195673368564,-0.030729763423,0.194476197296,0.148138557048,-0.692819555700,-0.913856114393,-0.016107600289,0.040117327322 &
            ,0.677781912106,-0.205966133419,0.297377845998,-0.000597002280,-0.677674070181,-2.033593574153,0.058627351986,0.035900597004,0.595169064743,0.081839770906,0.271930740397,0.238965984715 &
            ,-0.757221625886,-1.548570026155,0.047609644169,0.055116001908,0.714708980689,0.233609123198,0.069928835192,0.079882776368,-0.259703028057,-0.924771195274,-0.110358322836,0.048381353703 &
            ,0.244809701281,-0.006285261850,0.355487453460,0.039494518309,0.129443718533,-0.211650521315,0.072813384875,-0.015451992672,-0.115188185300,-0.020401871595,0.419860768197,0.356762618793 &
            ,0.715181346752,1.137957542896,0.383304238097,-0.019990069668,-0.683140092605,-0.233686105354,0.292779289518,0.594086208280,0.797173593743,0.769145547485,0.195381402094,0.015873844423 &
            ,-0.768634356304,0.042989367299,0.212969359226,0.316655226975,-0.576708744755,0.336899002203,0.288110632614,-0.088278788054,0.567599821485,0.191598927333,0.190352022117,0.779782466474 &
            ,0.297242377556,0.606682337071,-0.057319965396,-0.098451736529,-0.305257720887,-0.553398845163,0.071751360336,0.012381599644,-0.187681175091,-0.176786385149,0.229559259343,-0.101518583971 &
            ,0.191201251656,-0.520088830325,0.193396573943,0.258149823610,0.187996999842,0.217529154179,-0.012353691123,0.022162409536,-0.191674042161,0.078536272545,-0.092996155903,-0.079137255925 &
            ,-0.158963370613,-0.110010335443,0.203715802853,0.013191127901,0.174683560653,-0.016053048777,0.258894763365,0.179243935928,0.644714726518,0.437779426780,0.441707132228,0.005994944669 &
            ,-0.620861702915,0.029453657720,0.308543401862,0.339895171037,0.400812058774,0.124551722913,0.296030795260,0.031675090189,-0.401633574067,0.414611344769,0.395560038002,0.431889227898 &
            ,0.249100215679,-0.909744183234,0.194401974042,0.010875252048,-0.284485968714,0.488254844559,0.254696535314,0.106706343180,0.015585094446,-0.075799674100,0.026221253210,0.001300726985 &
            ,-0.018448725783,0.168109318121,0.084979435943,0.134795729064,0.039303997766,0.028029236722,0.020329282040,-0.003731090914,-0.036311989185,0.069067635511,0.013760207430,0.024525624772 &
            ,0.017219735797,0.012291419629,0.065647683761,-0.007008483566,-0.014862329774,0.016436925253,-0.056672137425,-0.005230800530,0.065242745528,-0.001197026524,-0.006589044201,0.000030022035 &
            ,-0.063503757087,0.062093120139,0.043669413063,0.013924980285,-0.018539030485,-0.079117433357,0.028016032330,-0.001637638013,0.020137894153,0.008123814049,-0.004059102386,-0.012986015873 &
            ,0.139793072420,0.144042182445,0.021088519577,-0.006072766515,-0.134979138747,0.019723782826,0.049465550156,0.069331248509,-0.088898754618,-0.124126254339,0.002625308239,0.010535916012 &
            ,0.089210245859,0.026884500623,0.015796710928,-0.032048783670,-0.049309416884,-0.077076801882,0.051885457258,0.022489438189,0.038884536333,0.029480181412,0.041152244781,0.031658355724 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/0.72358,11.6374 &
            ,-0.9425,-0.9798,4.6854,-11.1846 &
            ,8.5618,8.4272 &
            ,-13.7525,17.6842 &
            ,-1.514,-1.4742 &
            ,-8.4928,-8.554 &
            ,4.9349,4.7874 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-16.3379,34.6239/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/13.0457,13.9116,-12.1054,4.1299,-11.9585,6.1018,-0.39324,-4.6067/)
real, dimension(2) :: bias2 = &
  (/10.5403,-5.6474/)
real, dimension(1) :: bias3 = &
  (/0.4593/)
contains
subroutine fnet_ORRSL_initall()
end subroutine fnet_ORRSL_initall
subroutine fnet_ORRSL_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_ORRSL_engine
end module fnet_ORRSL
