module fnet_X2

! a = 0.015276
! b = -0.57708

intrinsic Reshape
real, dimension(8,54) :: input = &
  Reshape((/0.145113915056,-0.189804020210,0.696163426150,-0.835250070510,-0.547746565846,-0.431639359363,0.658797560283,4.772765745952,0.148194010474,-0.404422071330,-0.565963356177,2.802113593577 &
            ,-0.356934609786,-0.274187371775,-0.269905524991,3.521519920914,0.299422383625,-2.290883654898,-3.606284314892,1.335495779387,-0.420185642521,-0.575229658797,0.320536508486,5.457960589274 &
            ,-0.522576030904,1.261229375755,1.206280480123,4.439718367391,1.115225714561,0.082566595716,-0.354817857140,1.950938466485,-0.851235174519,1.501400163167,1.075065811833,0.495201464524 &
            ,0.544744004527,0.052168332732,1.182643240881,0.854935495927,-1.178150343742,1.954137559944,1.709892408235,5.217515816109,1.688347159045,0.470275380922,0.290638123609,-4.297242541311 &
            ,-0.082630762108,0.724966989977,1.329287179936,-3.662236273118,-0.229188402584,-0.191759527160,0.539140668139,0.541429298820,0.976656838514,1.349431682298,3.492390849503,-4.833431590869 &
            ,-1.175920619178,-0.056425156055,-1.092346910519,-0.793291008618,0.306895872249,-5.533712939198,-7.839923884724,9.740335475355,-0.617604302754,-0.585944846969,-1.228068184910,4.605685303748 &
            ,-0.371611638418,-4.465599188104,-6.218603708142,21.151121245428,0.921019804572,-0.307696473292,-2.338195778459,5.590206828807,-0.034450303541,-0.557173541613,-1.044677193466,6.371343890842 &
            ,0.191071624021,0.022709815658,-0.233662360703,-1.179400096143,0.110937025502,-0.386794939094,-0.686406651803,-3.215568861880,-0.274757393193,-0.119665652086,0.104095437259,1.946412539185 &
            ,0.015736851789,-0.279980371569,-0.252032459534,3.204604402185,0.159906414268,-0.102608760216,-0.377586847423,0.625199394302,0.070267869983,-0.428068152099,-0.940334942965,-3.721512115019 &
            ,-0.378651353572,0.135077914463,0.314199390244,-0.542212131419,-0.027359234807,-0.763873369372,-0.957761335790,8.513781026121,0.258858067143,-0.177632626119,-0.449700124607,1.790204084074 &
            ,-0.309083730603,-0.200345497810,-0.226460162828,8.222252585344,0.470894056939,0.134633328615,-0.524254903598,-0.946156364084,0.243999110163,0.087482817503,-0.243648812866,-10.658839585563 &
            ,-0.421279869315,-0.059472010042,0.296457131919,0.897913090981,-0.156775488584,-0.170508521589,-0.012699040221,1.715793553849,0.088289820156,0.155153836934,-0.058944383588,0.823514450386 &
            ,-0.093902748643,-0.343267882651,-0.504738787431,-0.157470668852,0.087995935025,0.032936937864,-0.155353303586,-0.354767300213,-0.058046050825,-0.813499813026,-0.663768852115,1.476488853998 &
            ,0.151549363186,-0.036675489951,0.034089517927,0.356237894342,0.042499006857,-0.528000986318,-0.763453658779,2.247520703787,-0.132607047409,0.033967028420,0.213541412879,-0.253776112600 &
            ,-0.058040857686,0.174657538185,0.185055322841,-1.253768328562,0.127675382791,-0.020056533223,-0.243404078788,0.042792046892,0.021405468519,0.799160837898,0.995919839818,-2.336089290032 &
            ,-0.083919286214,0.092015114494,0.130976082592,-1.021624866179,-0.070736017465,-0.535731789132,-0.815951313893,3.825882567027,0.090065858751,0.043651812543,0.032644959593,-0.975070692993 &
            ,-0.081800809117,0.507623949911,0.580154427575,2.057558885603,0.067550136271,-0.006701471749,-0.130082498146,0.461552982274,0.190042296077,0.141590045175,0.241041665762,-7.553903544927 &
            ,-0.244751729182,-0.035142559358,0.338390403191,0.459633910772,-0.106482928179,-0.185908429147,-0.269447612933,4.925887868742,0.195361047801,0.013225636314,-0.152204740317,-0.738599596059 &
            ,-0.274572728490,0.485437252972,0.510565015528,-0.140448576645,0.230805482684,0.035630081926,0.082837086595,0.427683084714,2.255494936438,-11.400221439439,-15.898415903550,1.622214321448 &
            ,-3.770241198798,-0.006808487284,-0.232974285745,0.030392904604,0.075701424438,-0.617152235784,-3.600962428200,0.298067518411,-0.062603066905,-0.042147821275,0.003568458952,0.384634378723 &
            ,-0.042951808736,-0.338711228368,-4.202818070195,-1.832831435781,0.056846922819,0.000757889678,-0.006493961593,0.087889176439,-0.210772134546,-4.071595267522,-4.811861988504,4.591820032357 &
            ,0.199089871993,-0.148632628605,0.105648967956,2.266833349587,0.078634696596,-10.004394130261,-7.590031840467,-0.742281680391,-0.060510925735,0.102376462081,-0.115215848754,-1.478190577028 &
            ,-0.030822590795,0.378583264361,0.584224028963,-2.958837928946,0.075184709166,0.047191208645,-0.024546383900,-0.711100879775,-0.161846279800,-0.315532032104,-0.312223455985,2.017296070038 &
            ,0.144271051625,-0.143772214184,0.095991019605,2.037784297860,-0.039293742855,-14.310745227227,-15.417762432005,16.553503681969,0.110507698578,-0.073121265324,-0.075523436424,0.662562426178 &
            ,0.351032732818,-0.256042766047,-2.428894744518,-0.529916262535,-0.683248871654,-0.109855587729,7.429157175279,1.518641953334,-0.398471437076,1.106259698813,-1.031497840411,-2.149087085006 &
            ,0.702826063582,0.060598099744,11.826057402650,-0.899214520877,0.056938489635,2.899401920773,5.164876715821,-5.776611140368,0.114518222479,0.203734287952,2.589307047676,-3.066592412315 &
            ,-0.317946528375,3.015769367802,12.344427397074,-2.688520055301,0.348568802545,-0.089505574745,-4.230015574626,1.226429366797,0.598196031573,0.582445507661,17.663898431006,-5.465483920934 &
            ,-0.982479221051,0.218770156673,11.987584145032,-1.862527866704,0.213198265095,5.447679151634,1.857074823875,4.470691031494,-0.607525265821,-0.360269253126,14.078675299108,4.188957473259 &
            ,-1.080205007112,-1.481208036442,7.939323490247,-0.784088330507,1.876752691560,-0.099260502884,14.668269249004,0.956954255433,-5.238291213543,-2.193586045687,1.857409771880,0.638408944486 &
            ,7.427078482905,0.543227647061,37.722262271600,-6.169405110409,-14.281794851163,12.489726427666,13.300108302025,14.542472237325,18.414352594323,-0.074461565410,27.523750451932,3.260494879287 &
            ,-24.564375091559,5.662663855955,8.439475650992,-21.943424848109,24.231246812993,-0.394619790796,24.767769579815,0.326966630984,-2.642158677430,-0.703329462146,-3.871506712416,-22.013665040083 &
            ,1.592580882434,-0.276510588665,10.163693324572,-1.517559863670,-2.972788283210,1.289404665152,0.773728250277,-21.727873867998,3.010828179289,-0.230016653249,5.771579886436,0.068863308359 &
            ,-3.095864877864,2.376080317173,0.322122191963,-17.703433201461,2.396325634908,-0.052280924337,4.562898928830,-2.538585705687,-1.662015373771,2.193094677732,1.501405808908,-18.543330261614 &
            ,0.574661618291,-0.208690845724,6.623117533931,-2.667691504546,-0.531425529278,3.882794461843,3.533050915600,-18.356099335166,0.411504467807,-1.232351200734,7.064398690004,5.779386583731 &
            ,-1.331962990923,3.785069211383,4.715067380174,-11.298500588873,1.160977989222,-1.056398381446,5.261439669152,0.612782267807,-0.707322005397,-1.116180256425,-1.268586836381,-3.339396729643 &
            ,0.427676574771,-0.408620640377,5.890917680053,-8.284717450452,2.255206503501,0.261772236732,1.340906743336,0.119215197170,-1.450455104438,-1.433177635120,6.721333754985,1.550809563325 &
            /),(/8,54/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/3.2639,-5.8592 &
            ,-1.1355,-13.905,0.87814,13.5441 &
            ,-0.55631,-0.44503 &
            ,-1.6981,-3.9338 &
            ,1.776,-21.9698 &
            ,-1.0374,14.525 &
            ,0.43852,-0.85619 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/0.27665,-0.71171/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/6.691,7.3433,7.3953,-5.5031,-6.4324,3.5878,-16.0856,-11.3193/)
real, dimension(2) :: bias2 = &
  (/3.4521,10.7268/)
real, dimension(1) :: bias3 = &
  (/0.68252/)
contains
subroutine fnet_X2_initall()
end subroutine fnet_X2_initall
subroutine fnet_X2_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(54) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 54
    inarray2(i) = inarray(55-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_X2_engine
end module fnet_X2
