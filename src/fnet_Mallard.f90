module fnet_Mallard

! a = 4.0627e-005
! b = 0.13661

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.079431078289,-0.107241484706,-0.238450462040,-0.282699106015,0.093840400933,0.038837027548,0.334959142962,0.058955403511,-0.270045051673,-0.140636134224,0.006331160339,0.098349464149 &
            ,-0.071315878557,-0.009708405034,-0.061974644035,-0.012878332829,0.031305942005,-0.163170456136,-0.199942794741,-0.257554765755,0.007478673372,-0.049088103479,0.117109776584,-0.053119181774 &
            ,0.656552556836,-0.112888980388,0.784692694238,0.499077789698,0.060248918895,0.069384232608,-0.370546749228,0.031536307836,0.782752093094,-0.121385551675,0.361357955555,-0.198330078345 &
            ,0.149411731548,0.119744144445,0.048194132652,-0.022452046820,-0.504336065629,-0.038441151925,-0.607019310868,-0.332126640158,0.054826317477,-0.006988846301,0.378748183439,0.041341863855 &
            ,-0.103097062872,-0.038176207018,-0.041925609072,0.203373700396,-0.047085731298,-0.025876704978,-0.239409964600,-0.020998379724,0.097230327654,-0.072142533968,0.088388073457,-0.262818134577 &
            ,0.025039093427,0.204221739069,0.565033303918,0.277491443658,1.574755834547,-0.042422991486,1.487436568028,1.006218462391,0.065730270726,-0.120076716718,-1.371946098144,-0.350382827408 &
            ,-0.792468475673,-0.054777535891,-0.540210957372,-0.206096008293,-0.106427731429,-0.159117391464,0.393456111207,0.055822630387,0.092935120316,-0.106641482954,0.028712193901,0.113709118761 &
            ,0.009936416079,0.150962295887,-0.092620054120,0.122098667239,0.005217104747,-0.119583424511,0.091948051428,0.006006207643,-0.038129733527,-0.046969148434,0.070307589754,0.009855436091 &
            ,-0.139493007276,-0.130981729762,-0.184960647982,-0.205145916682,0.045061435497,-0.058998234717,0.178485624316,-0.058428118814,-0.290545430819,-0.147908106071,-0.158899401939,-0.271960397225 &
            ,-0.002830425484,0.023429691715,0.308512888565,0.042991739768,0.153510764047,-0.164723800368,0.131938633071,0.033204668710,0.023941569113,-0.056358244312,-0.086464377981,-0.065838091277 &
            ,0.152139034196,-0.196190844824,-0.032754449559,0.101875979309,0.044583210642,-0.041834620894,-0.175980185876,-0.052845260767,0.210477210142,-0.234552964723,0.097109151145,-0.010980781475 &
            ,0.087803222130,0.063325590319,0.011624457827,0.034082289789,-0.360110556397,-0.264014690996,-0.375371022936,-0.248178505906,0.006117378319,-0.017286514610,0.347922309028,0.054731828177 &
            ,-0.285808389591,-0.185159937107,0.918001967470,2.266478241201,-0.653865705481,-0.460443167693,-1.923327141384,-0.111877389422,0.606887537117,-0.196502167467,-0.196034061885,-1.588297841288 &
            ,0.060158974137,0.054242446960,1.641534259628,0.176179574107,-0.668455788547,-0.204943089991,0.376380847223,1.213264491613,-0.798115174128,-0.316485619178,0.552278160219,0.950931246495 &
            ,0.904999536332,-0.208819173822,-0.330942835761,0.994287822503,0.201054574153,-0.524336391024,-0.965049417918,-0.363072585504,0.919939235850,-0.211409110198,0.154469261168,-0.220468965305 &
            ,0.874296381899,0.772882920228,-1.189945139438,-0.355916935551,0.128142786618,-0.204631914828,1.168830219243,0.553382188296,-0.486694223476,-0.364116685174,-0.012154295785,0.005395375908 &
            ,-0.594218127407,-0.193385725039,0.612903987928,2.078075479831,-0.087429175194,-0.292371063801,-1.679561237033,-0.327200278431,-1.328122203706,-0.154296780130,-1.717818739413,-0.110021328911 &
            ,-0.107895181553,0.271621095037,1.232290221170,0.879894990712,-1.249405616098,-0.102929249255,-1.343317832819,-1.411356026455,0.881308981067,0.634571591748,0.035288392413,-0.971507496976 &
            ,3.067320365258,-0.061464499533,-0.709904367643,-3.034334527357,0.859781515867,0.982588601616,3.045422761949,0.502432710676,0.477175096013,-0.054538898588,0.603153906794,-0.042705378779 &
            ,0.347867542792,0.180336939015,-0.101444746499,-0.227759522679,0.347097354087,-0.062435534789,0.167192560496,0.662978696732,-0.138567766321,-0.174241609356,-0.676634458992,-0.109584604702 &
            ,0.042796235020,-0.064940688068,0.137672437936,0.162473161454,-0.027858045862,0.003684954268,-0.193725577368,-0.001709988129,-0.055688336748,-0.070182269987,-0.659393437812,-0.920597587825 &
            ,0.115354657917,0.250799076385,0.214950325927,-0.130622781393,-0.914505351054,-0.069447595391,-0.539770467801,-0.188886879119,-0.260596063447,0.025941327215,0.034630115558,-0.026813249274 &
            ,-1.425055357209,-0.069414570218,-0.405462270682,0.523839557287,-0.463257679024,-0.037604181592,0.123080007732,0.199029849271,-0.745852559643,-0.062095529426,-0.117949303622,0.178446463632 &
            ,-0.420244231953,0.028443578586,0.236591025244,0.315333792694,-0.074868952200,-0.060372259660,0.793893255406,-0.625745004043,-0.648458476191,-0.215844316998,1.375309726448,0.490496373578 &
            ,-0.147095359687,-0.141625547606,-1.174792815728,0.169424357050,1.135705740447,0.222641537848,-1.399596989868,-0.767522668126,-0.124254215511,-0.147495256457,0.665233760901,1.463341893898 &
            ,-0.112166505182,-0.108272272127,-1.286347223375,0.083991947527,-0.442895770493,-0.105310421601,0.012933401636,-0.675473513454,0.171081176573,-0.715780769132,0.079334397629,-0.693303638590 &
            ,-0.516132303532,-0.244438145926,0.883235988755,0.031544992441,-1.136424074026,0.473815240031,1.084226908919,0.844088264638,0.937025925096,-0.142092964693,1.037985172489,-0.580572077424 &
            ,0.149833213483,-0.616389452942,-0.045967922555,-0.650523899406,1.470338694422,-0.195840564041,0.832665699540,0.383368132903,-0.667719999887,-0.169168599436,-0.275855475628,0.217176478941 &
            ,1.621825535819,-0.237584739170,-0.476135247831,-0.354584388632,1.259194603057,0.388923635786,-1.427123930569,-0.840800494294,0.607571230066,-0.164404405832,-1.026507256937,0.048377260216 &
            ,0.815125529241,1.876801692034,-1.002817423968,0.462856435984,0.571426951919,-0.225031014771,-0.058877547953,1.655488895226,0.895263677214,-0.743587858743,-3.216707386970,-1.078824525453 &
            ,0.439166800943,-0.089271938342,0.929550511355,3.173246418619,-0.431786345634,0.037157605064,-2.834818980133,0.202532070029,-0.239524375526,-0.160160031485,0.048903945009,-0.068813724798 &
            ,-0.217136894757,-0.271113448881,0.282781950374,0.046162052526,0.044264677730,-0.207253698525,0.166724101736,0.659937138474,0.064743643874,0.045740321728,-0.640354921455,0.008392425036 &
            ,-0.036178539426,-0.237976761558,0.078045328050,0.334792505938,-0.056959876754,-0.113325638072,-0.344190357458,-0.038532751562,-0.214602632522,-0.239939297265,0.200885113356,0.556310606611 &
            ,-0.175821421359,-0.073722139753,-0.154273137713,0.151846180362,0.409766510033,-0.212335326826,0.223331395099,0.066302635624,-0.062584363169,-0.044990126438,-0.254888728535,-0.029870610069 &
            ,0.222198796249,-0.180784676786,0.046586817218,-0.030158457152,0.183947567487,0.007521628069,-0.443536883925,-0.320112567516,-0.269726391599,-0.169130823853,-0.145627233908,0.222201890813 &
            ,-0.204286240016,0.013211508686,0.193408294450,0.301021490391,-0.764461102528,-0.144975613608,-0.494521120376,-0.206668195793,-0.309527222104,0.438609903034,0.302093043167,0.395024889242 &
            ,0.421626854235,-0.083034961924,0.068417821461,-1.128111062763,1.317514844049,1.393743258123,-1.366196269537,-0.732634936582,0.801277424392,-0.084044982901,-0.577669953206,1.017470171768 &
            ,-0.696988497447,-0.781145235144,-0.190902423409,0.404426044916,-0.518436236260,-0.086913947790,-0.674656358412,-0.804920865864,0.386539702239,-0.381058339199,1.218251067397,-0.434311009483 &
            ,0.467317672183,-0.086323071744,-1.350380424747,-0.722405118384,-0.274918966613,0.894487713591,1.721385711179,1.613732908772,0.468857191296,-0.086208907623,-0.693821875102,-1.421893305066 &
            ,1.800411841550,0.935891241048,0.175869015464,-0.863460039072,-0.082441064485,-0.081877862641,1.705547004565,-3.066986694432,-0.701380700449,-0.565395481176,-0.121064179682,-0.112010557126 &
            ,0.232777462801,-0.082066331436,0.065718078918,-2.355190459579,-3.327556977462,-1.375716630830,-0.761793157193,1.827225940372,1.148040042492,-0.079829905611,-1.593079761710,-0.037609666937 &
            ,0.388590935925,-0.029447490124,1.476158873952,1.729299029784,0.725939690038,-0.068154875521,-1.768291601466,-0.248045630316,2.428910187332,1.599711874481,1.782932508547,3.101582188165 &
            ,-0.067448656230,-0.061907841644,-0.509951888834,-0.926281267942,3.172504350562,-1.852677895892,1.381390715427,-0.674103198441,-0.116402560093,-0.060720149827,0.144701619990,-1.392895633723 &
            ,0.024107788099,-1.159894913057,1.180273358976,-0.659791318231,-0.107512672920,-0.058692242003,0.345254685070,-1.756601421872,-0.360812935460,-0.392741829603,1.099406683458,0.001670015863 &
            ,-0.042950828434,-0.061511477932,0.514068709729,-1.813413603211,-0.073757463386,-0.947835171600,1.253783211894,0.593223679212,0.161237856235,-0.060576391827,0.507289484161,-1.295376425727 &
            ,0.083022614662,-0.626815658610,1.949611042420,0.031594314951,0.097305740450,-0.057360972504,0.570343106105,-0.747129957123,0.627784950215,-0.615213622732,2.411774449899,-0.594030774671 &
            ,-0.189637090237,-0.062332208913,0.724000109012,-0.513311915894,0.696813641542,0.409437262675,2.204818214895,-0.543467608939,-0.556279599070,-0.057651986289,0.767104699093,-0.766493441518 &
            ,0.809824171574,-1.469120175586,1.529350721847,1.338256068634,-0.523613216904,-0.062246196363,0.301321532979,-0.365338102757,-0.669835395996,0.183673550437,1.601633475706,-0.001729321711 &
            ,-1.569430027982,-0.104607017094,-0.772119000896,-1.228157523084,-0.605716552791,-0.355953733091,0.414953225133,-0.045597203446,-0.377686057675,-0.104571062254,-1.224817467983,-2.179959683730 &
            ,-0.170359309542,-0.286527887071,1.979314713065,-0.032096931123,-1.099764205547,-0.108785230663,-0.687105512586,-2.610085134205,-1.122356984746,0.127591829497,2.681553551656,1.772736612620 &
            ,-1.184810260576,-0.112969329470,-2.773193634889,-4.641605541975,0.283259656258,-0.715687575934,1.507592398661,-0.618020337022,-1.686429996233,-0.117388856315,-2.192299748406,-4.659204085928 &
            ,-1.701439742208,-0.844577141511,1.771540855184,0.362453481839,-1.323984872859,-0.112439838025,-0.526533542115,-1.319288755604,-2.381022391558,-1.473504639302,2.024799958431,2.342829683482 &
            ,-0.168335877621,-0.114947534269,-1.757425863311,1.412419038899,0.568099944421,0.814883543985,1.885019627498,4.945031390089,-0.500830059172,-0.112160847289,-3.257647278834,0.455819779622 &
            ,-3.431576032858,-0.587621855373,0.297653261403,9.361440148531,-1.803049045392,-0.115517149355,-0.486525850007,1.505257992216,4.423225508937,0.300588467234,2.312849124443,9.234796093720 &
            ,-1.636991106317,-0.114950422769,0.081246464320,1.992295619745,4.776781335140,-6.589347284366,2.309111152731,8.673174581603,-0.150911134674,-0.117606632780,0.053600883570,0.580116985257 &
            ,4.585264288987,-3.539899311237,1.702963153350,-2.306959160258,0.208983779135,-0.121089962351,0.204325287734,-0.784110371412,3.004457689354,-1.774739459474,0.785690328889,-1.906625904227 &
            ,0.571502422761,-0.121246899429,0.331957888373,-2.267078107401,2.048058248379,-2.897843721208,-0.202361104545,-1.208443483217,0.961874193167,-0.123291349138,0.246427687771,-2.271216579851 &
            ,1.267899506185,-1.344427185803,0.016155700065,-1.382297695401,0.754626843991,-0.125209497194,0.254002481407,-1.499039647153,2.282438896872,-1.747833244510,0.405816211180,0.170098505973 &
            ,0.091257883742,-0.122481714430,0.482562793343,-0.007388697255,3.820188082027,-1.976237422113,1.325363882730,-0.983496743256,-1.184275809277,-0.127006958369,1.083616172958,0.527894169671 &
            ,3.066486627752,-2.432095414966,2.322375548234,-0.209136609528,-0.803985631976,-0.137289325716,0.012046945741,-0.849256730000,-2.774938517485,-1.481440766859,2.082885110094,0.680147734237 &
            ,0.432776226363,-0.198547093935,0.685965572778,0.700943526635,-0.340266090459,-0.348263510696,-0.481883076751,-0.032085547337,0.009374787023,-0.214369373374,-0.397232423913,0.674998453166 &
            ,0.145742048928,0.117421760857,-0.336440353416,0.173099771154,0.226548209534,-0.221764542183,0.539024836254,0.303365049227,-0.036138584063,-0.118213694662,-0.754047401680,-0.354803480012 &
            ,-0.256027540913,-0.247459128672,0.593623454243,0.947906771929,-0.533086752261,-0.378311430072,0.044017439360,0.203503074410,-0.618541064991,-0.235401302927,-0.917609744743,-0.037381275945 &
            ,0.468513240096,0.103631778525,-0.540807535071,-0.411965947316,-0.019927157430,-0.266875750683,-0.634781657343,-1.235429558947,0.317235855577,0.471973470823,1.496088353421,0.350933853785 &
            ,-0.121094883872,-0.322562662701,0.363622227609,-0.565577580693,0.108017650193,0.044516659705,0.239151946088,-0.331150918356,-0.462159680036,-0.339529851623,0.117644885155,1.593652170498 &
            ,0.013970027536,-0.102301875475,-1.766738447900,-0.660303326755,0.402628338004,-0.362590687020,0.454733998693,-0.717905446149,-0.239553802356,0.100170239766,0.896644698064,-0.216763913159 &
            ,-1.232253583125,-0.337040927659,-1.299592251628,-0.728697442433,-0.581737064976,0.246525832536,0.408295563044,-0.300765783431,0.216745708014,-0.335237134555,-0.322942191101,0.166470770221 &
            ,0.109773181202,0.228589840163,-0.587748629888,-0.097607026535,-0.119327563690,-0.338867144152,-0.065046582464,0.526649789267,-0.170621644812,-0.017335210138,-0.656368323837,-0.078887611992 &
            ,0.360085462484,-0.350781751760,0.414790316835,0.169928971916,-0.149394699098,0.120337712999,-0.126070248488,0.074219874315,-0.101645018844,-0.350507174738,0.093526189498,-0.383234553976 &
            ,-0.221430653913,0.155731883808,0.800360396341,0.342338226062,-0.440351087047,-0.360278561101,-0.118692853084,0.289389465946,-0.172548166802,0.154420464680,-0.115892747512,0.132364610201 &
            ,0.294264161184,-0.368772132684,-0.165312163931,0.484121425546,0.052448631285,0.053689995217,-0.815662220333,-0.232313894087,0.174974517885,-0.377847884941,0.033896101192,-0.509295617103 &
            ,-0.034838298797,0.154157297712,0.499399285828,0.028235248024,-0.802161500040,-0.386800001252,-0.634008639617,-0.748429252743,-0.043815369605,0.143259693621,0.750839964790,0.127139222281 &
            ,0.331291995207,-0.298496626551,0.320453643365,0.247017135194,0.064514396008,-0.017422518321,-0.521883101882,-0.203274204277,-0.372848500166,-0.217857793354,-0.868141161126,-0.649019071383 &
            ,0.284064416163,0.159493056220,0.431388895802,0.006570762654,0.475822873657,-0.127470408507,0.536691924559,1.012008158456,-0.213899046181,-0.262148590635,-1.137023386241,-0.194983198498 &
            ,0.142270130506,-0.137988192123,0.437237711929,0.044271994703,-0.282100954137,-0.116057068600,0.146264112499,0.146347499328,-0.667700874152,-0.128301887027,-0.979181671891,-0.511285493519 &
            ,-0.161661520078,-0.108730646368,0.484178858024,0.111010897295,-0.466924731891,-0.035627516712,-0.558278170599,-0.725593550134,-0.001822339558,0.005448344854,0.597397027272,0.003134621684 &
            ,-0.331435900533,-0.041812312602,-0.277940384416,0.278785848472,-0.069506749906,-0.145947887418,-0.280008351426,-0.101037115656,0.641030069352,-0.045931692489,0.613816558537,0.265925688087 &
            ,-0.066427644587,0.040029833617,-0.382256245163,-0.021084407367,0.082460049528,0.424836833417,0.065209686083,0.325337281639,-0.132184187457,-0.187273522497,-0.346179269765,-0.079196887229 &
            ,-0.823268685438,0.104753981309,-0.465344688102,0.003613099423,-0.162923428233,-0.059882704489,0.025188976847,-0.026918251759,-0.428400691435,0.068352718055,-0.490943434125,-0.266387302183 &
            ,-0.082079686770,-0.011450716146,0.311027079071,0.092834653366,-0.066483915582,0.104200542388,-0.006593979251,-0.007152904583,-0.023329900754,-0.024370209918,0.030357358635,-0.007198157505 &
            ,-0.258948222702,0.103952049936,-0.173228339912,-0.017433618498,-0.045075577686,-0.070679993881,0.047505203446,-0.028980511304,-0.046298054702,0.064124563557,0.086469050432,0.026643061046 &
            ,-0.022264466601,-0.028364959825,-0.026323531966,-0.037591020576,0.002717276109,-0.066024361406,0.013750993058,-0.046596967033,-0.007697356676,0.008759251561,0.004995448185,-0.014128646505 &
            ,0.069993909017,-0.073064830652,0.155262189922,-0.005885312147,-0.012498599191,-0.015955195441,-0.023541827574,-0.042339130193,-0.125480222605,-0.076247910951,-0.073735844445,-0.022730539270 &
            ,-0.029165326721,-0.001473628109,0.007846188108,-0.002028598396,-0.399000417045,-0.107559182188,-0.439939987875,-0.288738294767,-0.053936235154,-0.020986719380,0.377351770245,0.086819769017 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/3.3146,-1.4623 &
            ,1.4061,0.56726,-4.0865,0.32771 &
            ,5.7592,0.62521 &
            ,-5.2132,-0.58348 &
            ,6.027,2.7104 &
            ,4.3819,-1.1858 &
            ,-8.7464,-0.50502 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/2.4142,0.081201/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-1.1294,-0.32976,0.12353,-1.4608,-3.3604,4.4201,0.56017,-1.9641/)
real, dimension(2) :: bias2 = &
  (/-2.5524,-1.1303/)
real, dimension(1) :: bias3 = &
  (/0.14163/)
contains
subroutine fnet_Mallard_initall()
end subroutine fnet_Mallard_initall
subroutine fnet_Mallard_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Mallard_engine
end module fnet_Mallard
