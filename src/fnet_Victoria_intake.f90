module fnet_Victoria_intake

! a = 0.00043157
! b = 0.48884

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.191017759662,0.004778769006,-0.207970047382,0.031077655459,0.015214443681,-0.037662180003,-0.019491518737,-0.190835696921,-0.059827803005,0.010952973705,0.275652872557,-0.073194582787 &
            ,-0.029793110193,-0.232892014942,-0.151814610723,-0.039252222323,0.408657492146,0.126050768466,-0.340720198520,0.030073359750,0.195328659551,-0.158345094745,-0.162593187569,-0.447402685019 &
            ,0.117863754621,-0.023826693821,-0.115871441750,-0.122128073007,0.022568098997,0.160455513908,0.037680320635,-0.092723512890,0.063216053545,0.028639333663,-0.011419970239,0.006663160658 &
            ,0.110513551484,0.059475633996,-0.015778050776,-0.091068605252,0.016048737237,0.097041725830,-0.010191717284,-0.028845804931,0.189355677705,0.107870554487,-0.073733447930,-0.014028685254 &
            ,0.155752188647,-0.070901324178,-0.017875465839,0.011314226983,-0.190247957713,0.125398225080,0.195811991167,-0.170180208942,0.227333123296,-0.171824922144,-0.328973377061,-0.168334814939 &
            ,-0.086879558075,-0.229056052226,-0.034256807150,-0.185951419216,0.155944838510,-0.037924900670,-0.058694959596,-0.201848513893,0.007003917782,-0.189136605201,-0.164360306912,-0.192308355277 &
            ,0.198591722351,-0.033659336370,0.008238458898,-0.209545991728,-0.115937420846,0.157178840044,-0.031960671315,-0.245258029120,-0.089737068071,-0.014419650584,0.043740437817,0.031339869415 &
            ,-0.022217945426,0.065740614838,0.031367000554,0.095300511010,-0.053242190409,0.018911815195,0.068934624850,-0.004585910880,0.007321613958,-0.009142287441,-0.026296870894,0.051749690547 &
            ,0.080152562525,0.050417357811,-0.078371340917,0.065690274735,0.062557109552,-0.011200660905,-0.015140775213,-0.089151563115,-0.061662341810,-0.012473836519,-0.038871396575,-0.010885921722 &
            ,0.003618449342,0.029134251103,0.009761702740,0.107611727883,0.060899523723,-0.066427802091,-0.032863419130,-0.024525381650,-0.083869542353,-0.009036208190,0.049195825385,-0.076037433205 &
            ,-0.064995197213,0.007137379515,0.039355489837,-0.012487762758,-0.004133998203,-0.067681641740,-0.049919657598,0.074469179203,-0.026322805465,0.074153737613,0.075442020608,0.031650648708 &
            ,0.089753850908,0.009249770089,-0.086390338793,-0.012244201939,-0.114105047927,0.006105721922,0.103297473310,0.016242694622,0.026375208887,0.077031744164,0.006847076442,0.109996269545 &
            ,2.243233562574,-0.530581860228,-1.104158213290,0.011268559140,-1.189928409175,-0.730132936077,0.788808098254,-2.535770956304,0.672394332666,0.358360847409,-0.174956007752,0.512517656399 &
            ,0.340489436389,1.503673534301,0.416809909834,-0.932240862226,-0.101145724335,-0.473656279773,0.367215900124,-1.261094235144,0.216559263556,-1.199892635475,-0.700444483457,0.027166153176 &
            ,1.944744539133,0.807550428885,-0.323858214179,0.326916711768,-0.282647016270,1.201141134314,0.098914256022,-2.350089244680,1.622819878582,0.863938675647,-1.279108345949,0.882509702404 &
            ,0.767458008982,1.002473447412,0.346126826286,-1.612250500966,0.497835204557,-0.518734255081,-1.112442289643,-0.699474630517,-0.795891238782,0.669059424109,0.274382637124,-0.119272312075 &
            ,-0.038800175592,-0.982942116344,-0.043910541689,-1.809474222618,-1.704405038599,0.737688137867,-0.155812800585,0.123163946683,0.546050882863,-1.289458753077,-0.115581461146,-0.291619544770 &
            ,-2.145526672545,1.957478836419,2.249525867874,-0.465569314528,0.295594386083,-0.709070786540,-0.135067107655,0.104978378312,-2.292674771796,0.683057019066,1.186168632735,-0.150402826063 &
            ,1.048217957819,-0.375037307672,-1.674378767269,0.965839070000,-1.398795611665,2.369314673672,1.304694730053,-0.727404383952,0.250880067815,-0.061638095947,-0.162208025622,0.298859290851 &
            ,-0.238545480861,0.574457407347,0.344202658274,-0.301425722911,-0.010669174158,0.012875046737,-0.213684899885,0.270387033974,-0.027673743552,0.455161442873,0.207159774923,0.085478366428 &
            ,-0.284788162844,-0.128769837042,0.201036620554,-0.018454558765,-0.351589226737,0.344102488060,0.170106184083,0.363508206053,0.072002040602,-0.082080481607,-0.262568920078,0.325267097032 &
            ,-0.197552750871,0.200181210451,0.209366831525,-0.036256866467,0.197810131060,-0.148533048660,-0.377424896442,-0.108781122991,-0.044031985399,0.284227502571,0.043982030979,-0.145397189112 &
            ,0.093132697221,-0.239983121426,-0.030862848900,-0.304586451613,-0.347974464301,-0.117363598105,-0.140806155258,-0.118116192256,-0.841188866039,-0.224540017463,0.388169635633,0.035968265613 &
            ,-0.418411551219,0.606424506206,0.284393473047,1.062829870056,-0.845412978781,-0.496075452543,0.695535690745,-0.163131756480,-0.645278647172,-0.421774029730,0.121906905398,0.847572442248 &
            ,2.252101706177,-1.088956769203,-2.090424394052,-0.590151200586,-0.417218529922,-0.555074828568,0.551320085963,-2.540363541718,0.430195933298,-1.058794979062,-0.923836196502,-1.574080870974 &
            ,-0.079424388566,0.288527181915,-0.015606592157,-0.348326656518,1.943344928595,-1.209130997309,-2.460944258579,-0.518670988952,-0.225664897738,-1.283458514992,0.228320203894,-2.082842039463 &
            ,0.732157409016,0.082121269954,-0.786104174314,-0.081868670349,0.414364270552,-1.660186595695,-0.974526236840,-0.873127791159,0.958360874615,0.659302441081,-1.129228827822,1.271211249753 &
            ,0.534873545261,-2.072980908777,-0.858309542241,-1.080254197324,-0.096228389629,2.210772762570,0.528974903429,1.886184397413,1.188383455182,-1.458270835906,-1.735810567640,0.003738484888 &
            ,1.560488066013,1.408665777964,-1.292898774459,1.677122694270,0.782662477765,-1.234012184637,-0.917534265875,-1.728776597358,0.160783390546,1.341132589839,0.012122318185,0.423307491578 &
            ,0.875892330746,0.847901394962,-0.922843082446,-0.093550760976,0.589752396406,-0.758280153697,-1.390530617351,-1.451438147451,0.017581188944,1.081045212790,-0.065939217978,-0.401823857738 &
            ,0.522790878570,-1.013998757947,-0.762100776788,-2.143099720215,-0.163942557754,0.563451578290,-0.282852875385,-0.522307704647,-0.002685900875,0.001042075432,-0.053607850971,-0.140724557153 &
            ,-0.045122756972,0.122184931018,-0.081497584638,0.036169492360,-0.118076413748,-0.235775148310,0.116053917677,-0.265813972554,-0.114290836956,0.041078141865,0.128964530492,0.124403940802 &
            ,0.025503327670,-0.078012978376,-0.077977405876,-0.358551637158,0.078246204178,-0.099790733316,-0.267842827727,-0.034898243493,0.084525290088,-0.211194783690,-0.248848360767,-0.036234063795 &
            ,-0.134272372621,0.568894166679,0.439393104896,-0.012424480146,-0.151029742994,-0.093835384921,0.088952482227,-0.308673490569,0.020300842216,-0.015691027318,-0.212298787596,0.141007461993 &
            ,-0.111991258959,-0.117950673077,-0.013029379234,-0.152855840343,-0.171923822457,-0.413770041183,-0.152367022366,0.156937582569,0.210050336686,-0.056717725309,-0.072854700803,-0.040836627516 &
            ,0.081377968370,0.522903869185,0.343199304946,-0.228642434010,-0.025153080905,-0.134942955984,-0.140651512840,-0.262750263294,-0.029191284605,0.195565146809,-0.070755329231,0.062942166501 &
            ,0.884729060548,-1.391197536966,-4.231922947463,-0.912142181927,2.497569647119,-6.230785530864,-2.152126918551,-0.604354968953,4.248697218772,1.165618365506,-1.397992042409,-0.349204404131 &
            ,-0.880947623420,-1.321507217781,-0.472086248385,-4.619146790501,0.970326588415,0.562718238973,-1.004046319727,0.356584873032,-1.273025739301,0.510430675658,0.174989498412,-0.393125389031 &
            ,-1.331994895170,0.798195762495,2.503540569287,-2.177241933489,3.142142785699,4.650836227434,-1.603182250347,0.949216521275,-0.430087839852,-1.078069891257,-0.658197216020,1.595863549484 &
            ,1.137152699544,0.301345299973,3.000096575210,1.221651604569,0.952854073918,0.693364862173,0.835274055664,3.097121112453,1.609900644283,-0.360170403132,1.452503927913,-1.174054019763 &
            ,-0.826584230734,0.164603662960,0.392780090275,-3.004467425470,4.409888427881,2.768031747011,-1.978401128518,0.579553675142,-2.582884228534,-0.421561233892,1.362108196759,0.084679693700 &
            ,7.481904792679,1.202108384027,0.358078616012,2.136629211502,0.059352540647,-0.180287503804,-4.717020303168,1.845795956254,11.082429647456,-5.582597782261,-1.438534037522,0.010374948252 &
            ,2.340519240828,1.207610986322,-13.806747779280,8.910890911915,9.151472396185,-0.603511457625,5.891520473253,0.091160773199,-0.562154560593,-0.045154162939,-1.349318095681,-0.269088135300 &
            ,0.946226044057,1.264809297830,0.810308361468,1.113939908904,0.156836088312,-0.026197311832,0.518411816786,-0.466182457664,0.806010695454,1.078169247768,-0.540581714214,-0.435607951722 &
            ,0.301330302966,-0.173404876236,-1.610447516287,-0.441905900304,0.127926188523,1.370147875829,0.726225106321,0.006679364502,0.109778022322,-0.363339588348,-1.437037642842,-0.046129712028 &
            ,1.180927379898,1.974145186306,-0.203413192267,-0.043983282663,0.376634684494,0.843743673588,-1.030258729894,0.578043282635,1.028192568929,1.407085424532,-0.866206866160,0.199722028722 &
            ,-2.672230768097,-0.991267167663,-1.078686014428,0.948634624532,-0.321863227333,1.030159813005,2.025929121402,3.388583974521,-0.959082005799,1.299322624194,2.046873405733,0.414889874452 &
            ,1.348632074249,2.289242995916,2.471668286337,2.181451152637,1.869953831687,-0.395865204405,-2.890886112300,0.340127890133,0.638871488805,2.100231279684,1.018672065388,-1.811321511722 &
            ,1.938064946263,0.312901780894,-0.285606935715,1.208486138861,5.908385443961,1.857182183462,1.656887362159,-2.529120933324,-2.882556930850,-0.566264106790,1.902784211077,-2.631598678127 &
            ,0.743446699128,0.524960472460,-2.222300110254,2.919296194902,-0.949695409945,-0.565514074023,0.552552027754,-2.103736927656,-1.807824336705,-2.840698950081,-2.146189097496,0.930202127424 &
            ,1.802162994227,0.596607736471,-0.065209121058,1.047093053379,7.258141148255,1.059847193967,0.559254096115,-2.305494547174,1.289102793162,0.915477972436,0.277280095223,1.010248859717 &
            ,4.262215706563,-2.190840034460,-0.534147907410,-1.722100543210,0.197914165139,-0.510763970150,-1.192127029425,-0.471751689371,14.257195911996,0.131213488737,0.516778721301,0.428108006411 &
            ,0.241528469532,0.096277545456,0.516301098408,-1.116842852414,17.433571186143,1.078629282721,-0.593163816525,-0.300870786403,0.170218528425,0.514893774484,-0.236716435666,0.941940454857 &
            ,21.929912806733,-1.139913432917,0.421186016787,0.296532934693,-0.421269771196,-0.016542676748,0.494683026145,0.822892877601,15.133159321607,0.178820101247,0.812945826800,0.692351961375 &
            ,0.843032088463,1.250807533623,-0.376101004938,0.421512658025,5.188936612187,-2.330099438013,-2.226131094509,-0.710576279595,0.477097927329,0.421387044249,-0.852862643387,1.106980076876 &
            ,0.180076682219,0.067390292003,0.519617669866,-0.254893427116,-0.027986485969,-0.300142587147,0.324495715684,-0.366317966606,-0.045610432211,0.042691524582,0.038550633121,-0.067299627769 &
            ,-0.131722848657,-0.228538958205,-0.103564373414,-0.160809666915,-0.404732917295,-0.792526259461,-0.096600589533,0.214359151735,0.439290574020,0.346784035930,-1.046532022158,0.883312542454 &
            ,0.772810357074,-0.035107383739,0.218388244138,-0.239509812273,0.488464787686,-0.167765911475,-0.308121280285,-0.226495710669,-0.062020666472,0.603991942436,0.310047309308,-0.568600106662 &
            ,0.680162371694,0.181592405079,-0.231005976701,-0.032685083611,-0.555369921686,-0.169871655183,-0.153566208632,-0.706573619405,-0.948795994433,0.049476510657,0.609098216054,0.496559424473 &
            ,-0.632078724468,0.636732809438,0.693848695744,1.295089528348,0.361481042285,-0.737851314851,-0.437874019349,-0.960356046380,0.354037593387,-0.917856361755,-0.464496747637,-0.616323861303 &
            ,0.570153146120,-0.189929700095,-0.732369685619,-0.337422187048,-0.385212766985,-0.620410189177,-0.183471613875,-0.452761216241,0.967204125234,0.022286966633,-1.037964721890,-1.256729206413 &
            ,0.750235468838,0.493482562165,-0.850487346161,-0.944995117045,-0.518274260931,-0.207613949882,1.119003183900,-0.451104695346,-0.326248272379,-0.315458654941,-0.273319628107,0.243352063056 &
            ,0.451785800376,0.106143221417,-0.264904583247,0.179632437025,-0.638627064020,-0.979230333763,-0.139588346651,-0.369174955314,-0.578865819281,-0.337422191232,0.238666282808,-0.380562293855 &
            ,-0.424015595812,0.885717653785,0.583734166711,0.790454448146,-0.524277395243,0.136808401622,0.195693355536,0.382238209261,-0.634789738317,-0.128455436135,-0.205043758247,0.523289407462 &
            ,0.359395925223,-0.303528379769,-0.510008451050,-0.558544433976,-1.248474338942,0.008806384512,0.060005515189,-0.196676744184,1.223122417849,-0.094350106812,-1.011345832900,0.303826921514 &
            ,-1.464495835451,0.571085252384,0.389334684264,-1.394721315771,0.338467189737,-0.080386131079,0.027547420873,0.562649398788,-1.587352493732,0.852227970827,0.357881730952,-0.702158219341 &
            ,0.607059778646,-0.043786010725,-1.061812594316,0.478404644647,-0.559655093135,2.649545299646,0.616093797883,-0.521072351707,-0.081472859357,0.041033016024,0.407305121260,0.002775359753 &
            ,-0.161586598090,0.056201419474,-0.145257406686,-0.038854374613,0.128743555855,0.004061864352,-0.128727202188,0.063585675178,-0.038262558049,0.257898552541,0.050277512260,-0.124993896061 &
            ,-0.229453805572,0.079149332430,0.386481516344,0.150037609514,-0.065832982069,-0.090254944812,-0.063067822515,0.157384656644,0.140537564582,-0.116298600192,-0.069198096064,-0.115852142372 &
            ,-0.185551664963,0.298757407630,-0.010547873254,-0.206898302775,-0.014880181829,-0.004045818866,0.165429800922,-0.066822254485,-0.045394691544,0.139015022781,-0.065267988172,-0.053175245601 &
            ,0.137224512757,-0.025892772801,-0.018073826876,0.034736714022,-0.083432173183,0.483994111031,0.030112340885,-0.219797195173,0.575517244088,0.078907258680,-0.389292297604,0.157535524256 &
            ,0.084047530451,0.378341484489,0.020400529862,-0.709852838764,-1.216253378836,0.250069965178,1.275445567013,0.528919023348,-0.081549459213,-0.071894384647,-0.201634950212,1.078849214885 &
            ,-0.076706710778,0.021490063577,-0.154456711307,0.279090261039,-0.095565667448,0.149790376463,0.305597938866,0.221076232837,-0.110757651290,-0.092581640285,-0.025342377906,0.191260580740 &
            ,-0.293675214225,-0.273976582661,0.272606873515,0.247526149652,0.071381584357,0.210983360571,-0.122536183590,0.502423393856,0.001222762628,0.056212957206,0.115548291215,-0.070439729653 &
            ,-0.250612264778,0.073806274305,0.175603304306,0.474987118688,-0.024997922944,0.489646286648,0.397262302474,0.258232144914,-0.185751611638,-0.038412877315,0.288637830552,0.085971433718 &
            ,-0.162886211087,0.094167075358,0.200822795921,0.191533336693,-0.301723040204,0.016717901386,0.280870062114,-0.018505882633,-0.004998096526,0.137187974904,0.033365085622,0.345493849112 &
            ,-0.599074482496,-0.032273710842,0.282907729002,-0.165355347308,0.199380107763,0.278059430494,-0.116469506278,0.685292590929,-0.674858118215,-0.008672277704,0.269288263986,0.114727221467 &
            ,0.169548764111,0.031577609875,0.010809668324,0.818807211514,-0.670774513240,-0.031736817853,0.467535235922,0.046865208687,0.231188266752,-0.260624497973,-0.058602916773,0.724764439580 &
            ,-0.873711909162,0.112207924682,0.747694583383,0.051635611646,0.443208274423,-0.962680730648,-0.364604684322,0.915062077235,-0.017875287722,-0.021630603839,-0.009896731542,-0.002914295369 &
            ,-0.007379124849,-0.098591829243,-0.040286166593,0.013078135994,-0.097167922422,0.036087731002,0.096134387613,0.047168241141,0.038654901977,-0.081086235525,-0.027885423145,0.096010215242 &
            ,0.021583097234,-0.023182953220,-0.028388492429,0.003804803716,-0.022193976607,-0.014868521984,0.007404279006,-0.025234316725,-0.008688765669,0.000686710026,0.020773682081,-0.010101260131 &
            ,-0.009989724168,-0.052201451467,-0.024790958214,0.008232788566,-0.110158159485,-0.000746419280,0.083847727306,0.023038200889,-0.017551600296,-0.002735144212,0.005863629721,0.117603280163 &
            ,-0.011047734898,-0.005151129532,0.020313367510,0.019010834752,-0.024784947725,-0.018859339116,0.025398251918,0.008957522263,-0.016834748511,-0.001959184118,-0.009194706237,0.030035270051 &
            ,-0.027978465295,-0.001369744324,0.006948466576,0.024665410029,-0.004590912898,-0.005295645314,-0.103288980549,0.003126196380,0.011565943191,0.120181497022,0.042311876473,0.057176667194 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-6.8795,-12.5562 &
            ,11.8021,7.9789,-2.7533,-4.463 &
            ,-2.3886,-3.8366 &
            ,-6.5904,-3.4214 &
            ,0.75718,-1.3587 &
            ,2.6246,4.4165 &
            ,-4.5658,-8.4569 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.18528,7.5739/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-9.696,3.3518,11.4492,0.40838,-5.3826,-6.1651,-3.0291,9.0506/)
real, dimension(2) :: bias2 = &
  (/6.748,7.176/)
real, dimension(1) :: bias3 = &
  (/0.66952/)
contains
subroutine fnet_Victoria_intake_initall()
end subroutine fnet_Victoria_intake_initall
subroutine fnet_Victoria_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Victoria_intake_engine
end module fnet_Victoria_intake
