module fnet_CVP_intake

! a = 0.0003917
! b = 0.45293

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.162395372720,-0.134244703299,0.013131534595,-0.159572352915,-0.099357638020,-0.034578924560,-0.031619580128,-0.022696685268,-0.341260142839,0.205986251111,0.114456577208,0.343444646197 &
            ,0.212908892475,0.144250704327,-0.028830493060,-0.057274961836,0.638404486435,-0.129806364955,-0.400403223661,-0.664255713404,-0.215731535378,-0.198428602438,0.111401590371,0.142856713717 &
            ,0.118100169665,-0.111278957115,0.225720563141,-0.115712101691,-0.023876454245,0.044888210804,-0.113439589293,-0.098845019904,-0.899413767103,0.058231354863,0.106401707728,0.934887567079 &
            ,0.050424545972,0.073422186034,-0.121097454269,-0.116790318214,-0.071194833141,0.045916117621,-0.029477844366,0.073039013817,0.086712961480,0.085447396405,-0.004910141388,-0.040867544180 &
            ,-0.048684055539,-0.083278225202,0.026193474383,0.052248665653,-0.030091381198,0.034745006551,-0.097453597708,-0.087965066865,-0.341956296261,0.176812531621,0.110425412992,0.346646629626 &
            ,0.279257408148,0.259618533978,-0.110931431580,-0.167263903400,0.746703739280,0.058297538794,-0.343924857269,-0.786881309392,0.032788806537,-0.021694449032,0.069375669603,0.068135028733 &
            ,-0.261155836973,0.014137880679,0.214650244425,0.275740144600,0.077864228926,0.103449657966,-0.082997675498,-0.100503163644,0.003039195980,0.044655970634,0.034710021150,-0.005285215433 &
            ,0.017115265414,-0.008690980811,0.023752110518,0.024872786230,-0.018421700191,-0.002295798456,0.015582516509,0.019507896414,0.016766487170,0.024224164473,-0.011172189950,-0.018533150526 &
            ,-0.047320024445,-0.033855972626,-0.004158046641,0.051322102699,-0.036206159279,-0.014101283013,-0.018853825860,-0.013476390698,0.000885302929,-0.064585524670,-0.024337494027,0.003290576220 &
            ,-0.066816303023,-0.039126313791,-0.004687188314,0.005494743224,-0.129116125184,-0.079645953017,0.012955110764,0.139184189446,-0.026411805991,0.035969225507,-0.058184566732,-0.068664469735 &
            ,-0.140724919805,0.065175362321,0.090454498490,0.143101289163,0.085918228795,0.092641112396,-0.079193280417,-0.091653544350,-0.261728231190,0.124737829167,0.050021946418,0.261243712687 &
            ,0.142546457356,0.115663583532,-0.045011116375,-0.067147672543,0.259037368641,-0.157741314363,-0.252243975706,-0.264669096214,-0.258113663179,-0.237847313594,0.145522603319,0.182508785270 &
            ,-0.004052180876,-0.293787543007,-0.377694861914,0.029497397811,0.250751478270,0.642902160747,-0.705792891778,-0.826759357667,-0.548270903625,0.884175053363,0.967086082088,0.563031801203 &
            ,1.009535042628,0.662479114081,-0.044360575920,-0.231351633717,-1.355909253170,-0.400149260687,-0.665041092327,1.380728963108,-0.243671379144,0.149137967167,-0.353545890857,-0.363246677379 &
            ,-0.842921128724,0.188564180316,0.014497200001,0.867838562213,0.251155756953,0.261673652359,0.133077332573,-0.048963438232,1.153424607504,0.486562193946,0.781674343475,-1.199868353307 &
            ,1.052630919562,0.885039256890,-0.363874721458,-0.522219149290,0.589906096040,0.291755977008,-0.376054448720,-0.658125368122,0.524011218303,0.463300308397,0.308413057798,0.032101290360 &
            ,-1.280242082001,-0.058530160924,1.368796354133,1.364870019378,-0.192515892754,-0.253505103620,0.339928767408,0.318237258206,-1.328606794504,0.884569586519,2.397665684877,1.402826513787 &
            ,1.278219547805,1.155883586904,-0.603269718924,-0.857248787161,0.381296873232,0.303367840460,1.769675856292,-0.454445206469,0.650338641624,0.814046307591,-0.736526978237,-0.821307030058 &
            ,-0.410498643840,0.891911326572,1.057691739414,0.405355094851,1.169937283907,0.897721926722,-0.335866386706,-0.510538968081,-0.332349544173,0.201941185925,0.085900350855,0.340548850346 &
            ,0.221296268132,0.165789402440,-0.051145039236,-0.090255597814,-0.066307989437,0.164594215833,0.066738959559,0.061150638130,0.223382528626,0.178457336324,-0.075616282156,-0.105931170943 &
            ,-0.226697109791,0.093300904951,0.099754125426,0.238858865718,0.047732402845,-0.017627042438,0.034758015872,0.046829106009,-0.426414030329,0.231415750464,0.172327211391,0.438224185341 &
            ,0.221860460230,0.166623624297,-0.097773821270,-0.123016906641,-0.945400374863,0.465357644681,0.464387089423,0.965018639018,0.452876824794,0.385582717708,-0.218664687396,-0.293290840910 &
            ,-0.677901481256,0.447160010141,-0.005270129134,0.714285334559,0.640008276221,0.661927930828,-0.572126792240,-0.677094100105,0.377681192373,0.245808893261,0.074725513033,-0.411893005763 &
            ,0.164668384050,0.065187672481,-0.060841470782,-0.035361229209,-0.252301380131,0.778855135066,0.037689207312,0.246853330485,1.018501010408,0.884732269032,-0.492227143648,-0.662207110679 &
            ,-1.153011454670,0.763416610196,-0.267819277130,1.155845448104,1.214496994931,1.248855684548,-0.861388528684,-1.081601690224,0.839107577034,0.111579968651,-0.562740153519,-0.905987584469 &
            ,0.608386795538,0.825018127659,-0.957430082308,-0.978330912911,0.513350228847,-0.030857608285,-0.913166669874,-0.523513811235,0.582074482288,1.011154644954,-1.211682162070,-1.320006467404 &
            ,2.298499965377,0.271473090599,-0.757615976317,-2.424669262259,0.642470281202,0.611430725127,-0.543285887719,-0.566056428949,-0.183227445421,-0.180905711341,0.009218822359,0.233713729880 &
            ,0.247589838743,0.478605876856,-0.535608548845,-0.609311897548,0.555940192281,-0.365555498585,0.281521489994,-0.544107310559,-0.259911625581,-0.281882942905,0.353230170268,0.354944623345 &
            ,-2.544748797843,-0.031979664685,0.489961542370,2.685382929928,0.188619220233,0.318030376109,-0.043652188554,-0.232256516073,-2.128049516042,0.077105629466,0.870409865187,2.206080985970 &
            ,0.152544002327,0.077201145636,0.180643932007,0.113302607390,0.016557893090,-1.328729058026,-0.966083421968,0.032486862522,-1.371624058917,-0.576308086416,-0.177992747431,-0.126630535681 &
            ,2.914979437115,-0.744270524577,-1.474053607776,-3.066603730756,-0.834635848797,-0.373921540999,-0.128386799333,-0.047590587290,0.394931339789,-0.082263479036,0.144561541163,-0.406634743721 &
            ,-0.129557010098,-0.103026215721,0.042468633107,0.061054986750,0.083924693103,-0.145319069666,-0.196895769535,-0.085270278892,-0.168264380757,-0.093252089997,-0.060539004899,-0.018605470533 &
            ,0.382079776280,-0.233883032466,-0.212073139965,-0.393424209692,-0.219838965850,-0.114124528821,-0.008137669116,0.016211072160,-0.371926444546,0.040877581986,-0.051105896546,0.389244001964 &
            ,0.054069618335,0.076065184630,-0.067313622502,-0.085555804178,0.532707987352,-0.136665090575,-0.193274701373,-0.555528378942,-0.184554989895,-0.133978478005,0.026919865111,0.057729708047 &
            ,0.816248706016,-0.310116283274,-0.312091437963,-0.845319724040,-0.254280782436,-0.073470045891,-0.079865125713,-0.069266956348,-0.755764930107,0.098227084862,0.055828099845,0.790305363445 &
            ,-0.017880631348,-0.109811497366,0.073594014025,0.113219207903,-0.247311278663,0.037268216740,0.246121830433,0.255695992517,0.124069255769,0.177232345296,-0.127539958306,-0.165296408975 &
            ,-3.611551396838,-0.997152409793,-4.208156987143,3.886006538621,-0.844783059433,0.170145547061,-0.710108701703,-0.973924738474,1.012643205189,0.738349259454,-0.043333568405,-1.131955247326 &
            ,2.102111198321,2.436458692084,-1.142413139367,-1.851163679264,0.184821505061,2.392733532327,2.066688902227,-0.241713473417,3.643472323330,2.844687950443,1.006570220137,-0.246466772395 &
            ,-2.139761983031,1.983896432967,0.297965772278,2.096930191614,2.248652177058,1.759917540721,-0.108434682495,-0.742270557954,1.282538708409,-0.587647075964,-0.411061114039,-1.217133787722 &
            ,0.701392357606,1.166479834934,-0.640549237723,-1.028624392854,-1.691224889501,0.607823196829,-6.654736819712,1.845196804473,-0.781586123749,-1.509843256288,0.931097723121,1.272950026344 &
            ,0.869215851277,0.564958331050,-5.873888252064,-0.992310249585,1.272681462498,1.367463314336,-1.144088084097,-1.329423147551,3.651590812081,-1.960737478861,-1.606057999597,-3.626543727245 &
            ,-2.244642949919,-1.879775337435,2.921687362774,2.539573755155,-0.642811644865,0.655445265424,-14.497071042632,0.577684498730,0.478282401702,0.291560877609,-0.768706014451,-0.509197111112 &
            ,0.248452048698,-0.451119664587,-10.544345224546,-0.284378626897,-0.356342510170,-0.171567738291,-0.879154988473,-0.621208977787,1.137652352437,-1.008018277346,-2.846626646640,-1.146511218006 &
            ,-1.538848345849,-1.134821614379,-0.939627485804,-0.288393061268,0.866118898149,-0.364975284101,-2.345798249444,-0.945344869455,-0.019624384621,-0.161627819877,0.411791567345,0.548193572260 &
            ,-0.214626398134,0.196291155516,-1.304713303606,0.200203163609,-0.423779729094,-0.220210834142,0.348205418763,0.062895261667,-3.282178721670,-0.045677470103,-0.872380738255,3.494335352576 &
            ,1.043313500870,0.658858500994,-0.477973845595,-0.401248316542,-6.828410141582,5.384938498839,-2.073229978150,6.804558479821,3.205241022543,2.829479112909,-4.107990560870,-4.154126720193 &
            ,-4.040882158856,2.843312620523,-3.033983488525,4.400124364417,3.468492071398,5.107886512593,-4.795195043618,-6.325206154679,0.749222562534,-2.750606550229,-3.182687693132,-0.667843005327 &
            ,0.892534461500,1.566604154173,-2.489776647446,-2.128520310465,1.206079278891,0.160445075001,2.709679843327,-1.409497497782,-1.805589582625,-1.914842594108,0.242926633827,1.054564878337 &
            ,-0.797716865097,-1.179057517945,-5.605445468549,0.878701125874,-1.004659339604,-0.349304679539,-0.885049590810,-0.583761621915,-1.240630381473,1.127028999740,-3.713441353046,1.280629150337 &
            ,0.659531943374,-0.029059846856,0.678835412574,0.586389307392,-0.126634052441,-0.694193053384,-2.789597920570,0.107486243307,-1.106632939576,-0.919205091557,0.126513185407,0.435477201634 &
            ,-0.427718013135,-0.320533919192,-4.047411809194,0.483582223417,-0.439482559109,-0.281918850120,0.206098191305,0.185789402879,-0.711324153319,0.034779921600,-10.098331616739,0.737551256327 &
            ,-0.253594227179,-0.280818977904,-0.155691461312,-0.035218060141,0.581776389177,-0.257322370068,-17.375745289523,-0.650789722230,0.106695404633,0.266793587441,-0.222154943753,-0.148133209851 &
            ,-1.369687061413,-0.220928338562,-18.790498647671,1.475962044763,-0.449267075352,-0.323649143566,-0.372736123643,-0.156217262335,-0.844842199374,1.144504083520,-36.931911250756,0.850726651633 &
            ,1.984749417728,1.732223369094,-1.133660741723,-1.296005989489,2.096447122182,-0.354528863852,-39.648623185803,-2.189675988138,-0.027361725694,0.260293364824,-0.128166329081,-0.272433355096 &
            ,-0.854886425737,1.481350795327,-6.857873847613,0.867792655127,1.782776524986,1.160720116263,0.437370866406,-0.034581971642,0.058074648312,-0.021781119938,-0.110197946763,-0.059271320251 &
            ,-0.026103124106,-0.050233913328,-0.105211740692,-0.031596785900,0.008571009106,-0.017477116001,0.234230381959,-0.006423829311,0.009820614125,0.033418356404,0.298805228927,0.176804454437 &
            ,-0.268581621822,0.019901342924,0.070947515940,0.288824710347,0.030244761214,-0.003960689012,-0.363818910129,-0.216161977996,0.168858247406,-0.033055856675,-0.162444530843,-0.173031452603 &
            ,-0.139558872715,-0.174621424995,0.107692261750,0.155430655127,0.739049957171,0.070634590013,0.312837281613,-0.768258876944,0.601859633797,0.735313339211,-0.867593451100,-0.874512474013 &
            ,4.755441759287,1.384324137267,-2.088898220785,-5.042009638348,2.730470560092,2.845944374276,-2.588104562016,-2.881494701652,2.559389338083,-0.119479693365,1.044379409024,-2.727153760657 &
            ,-0.653243354244,-0.888880386534,0.915357289038,1.102220460796,-0.171669438635,0.079512462911,-1.683463901058,0.214451832344,0.672877088977,0.972075873163,-0.748643765478,-1.021469463043 &
            ,0.249300572197,0.229092950036,0.147025477595,-0.285260921367,0.424967415812,0.388543657019,-0.135400588970,-0.220532657134,-0.175746714719,-0.311491630868,0.435408245470,0.214850161118 &
            ,0.098542985581,0.444213767843,-0.616134026222,-0.670390550006,-0.192180868793,-0.926336994218,-0.487078455574,0.240343231888,-0.829847536214,-0.305128499093,-0.282882749890,-0.197089373355 &
            ,-0.309113709273,0.197685050812,0.695426059136,0.301973864713,0.239139716779,0.139695880097,0.035453280902,0.015726334591,-0.883641529151,0.613728903737,1.014823185999,0.899488339801 &
            ,0.822115519385,0.673533968177,-0.299052329012,-0.429525321179,-1.302459601474,-0.168024263486,1.176911778020,1.358624351395,0.016387570764,0.284414700216,-0.447547151987,-0.471578392129 &
            ,0.130924459209,0.055197605008,1.057700552211,-0.137122976672,-0.034795329466,-0.119067431322,0.326481250047,0.267808840488,0.214425288344,0.001389662738,2.135618807806,-0.212694424229 &
            ,0.241016155809,0.344007289458,-0.295243207896,-0.370684562743,-1.736893111733,0.363199800873,3.862742155902,1.806360914179,0.312403206311,0.266984447310,-0.246200167537,-0.262450002465 &
            ,-0.156549720378,-0.340857621175,1.187469059780,0.184263609872,-0.533133602777,-0.445471460035,0.094205590497,0.217693865892,-0.144924966782,0.056782673772,0.169438944841,0.153980850573 &
            ,0.067712389417,0.067864486916,-0.088792560973,-0.083205862174,0.027763121498,-0.030811981550,-0.008746119217,-0.028686685449,0.020181972905,0.045601752004,-0.094851121223,-0.081090781286 &
            ,0.281167080858,-0.128002763376,-0.097899459056,-0.288086122926,-0.249064547656,-0.286462762962,0.161802326458,0.235837484261,0.342969510565,-0.174065853513,-0.187126196831,-0.348314668297 &
            ,-0.093864729934,-0.037108615777,-0.014430083421,-0.004736874043,-0.148032343524,0.088957096756,-0.008254928971,0.146309629133,-0.090890813012,-0.190375082179,0.234820914768,0.249903932390 &
            ,-0.858212978479,0.289769073271,0.345760868354,0.877730723226,-0.133141549542,-0.305276006514,0.252649186239,0.318391482224,-0.777588940999,0.511668157179,0.679141257510,0.781212872465 &
            ,0.423995450195,0.307673341384,-0.104329301914,-0.162266965919,-0.481021077577,0.818357914833,0.559281765412,0.464706978425,0.508170974717,0.119500686486,0.254822524160,0.206997905059 &
            ,-0.038524580878,0.118286019722,0.003895289143,0.032211307896,0.161174696238,0.110448561209,0.085669579530,0.020370887445,0.107922464769,0.290203244664,0.096159295495,-0.127031764260 &
            ,0.267282918628,0.116969365092,0.079361769526,0.041285537749,-0.085074691896,0.301191869745,0.175001049759,0.077966777166,0.345361575641,0.214956277313,0.047082314959,-0.025908893994 &
            ,0.147556910559,-0.016221590969,0.110029048257,-0.149029628452,-0.179088328484,-0.261267739494,0.175211065999,0.238178956967,-0.113379609173,-0.103266068736,0.065030323753,0.124218387241 &
            ,-0.255109462815,-0.302931080315,0.175128629918,0.251665826469,0.408353177708,0.164273911814,-0.011733660428,-0.426738049240,0.052081585480,-0.099448793529,0.126185305825,0.159678180030 &
            ,0.474528573460,-0.084206828160,-0.345636363491,-0.491225621373,-0.115327665236,-0.118149450713,-0.008251305956,0.045140667152,0.762953736076,-0.221609304778,-0.581867857614,-0.779773857727 &
            ,-0.197630829737,-0.127383637231,-0.010535394062,0.024505077869,0.893590678625,-0.116667243329,-0.342847924379,-0.919939407532,-0.138017811090,-0.152642363879,0.009786273479,0.080000296114 &
            ,0.324665754983,-0.067560378852,-0.215099111829,-0.332232572262,-0.008707978841,0.024721101879,-0.096229694666,-0.073771031392,0.013359014219,0.041782534671,-0.062156011569,-0.018406469255 &
            ,0.026236568379,0.013186530736,0.012684730248,0.004816176792,0.013714557032,-0.003842467869,-0.036276190781,-0.014505258900,0.007281156541,0.016062635887,-0.007335061469,-0.014135385747 &
            ,-0.044584101779,0.016601617733,0.016359463781,0.046451857677,0.033845901662,0.042570319192,-0.032536711325,-0.041719256947,0.037352239466,0.011701109109,-0.019788429564,-0.040483160697 &
            ,-0.026613227361,-0.049645965924,0.048044043711,0.057125189755,-0.041678767941,0.012151090327,0.026575439466,0.041575692091,0.001143450387,-0.001424477211,-0.002869104960,-0.000493332358 &
            ,-0.064496444469,0.061760981535,0.079756177599,0.062215821112,0.041999185451,0.023106842351,0.002523350866,-0.002398449738,-0.097078919095,0.025876779547,0.099813870786,0.096599265294 &
            ,0.026545752824,0.030649713845,-0.032347625244,-0.030977118233,-0.171126958148,0.035399206680,0.144681659730,0.176545588732,-0.016565645896,-0.036412563979,-0.008225442093,0.016469216723 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/1.0748,-3.7247 &
            ,8.0264,4.2431,2.5181,2.5641 &
            ,-3.3606,-7.6492 &
            ,-8.831,-3.6224 &
            ,11.1391,2.9539 &
            ,-3.843,10.6837 &
            ,9.459,-2.3625 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-12.4384,13.0868/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/5.124,-2.3893,13.5153,-5.2941,-7.131,-8.0807,4.0469,6.8621/)
real, dimension(2) :: bias2 = &
  (/-8.7801,2.1702/)
real, dimension(1) :: bias3 = &
  (/0.54381/)
contains
subroutine fnet_CVP_intake_initall()
end subroutine fnet_CVP_intake_initall
subroutine fnet_CVP_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CVP_intake_engine
end module fnet_CVP_intake
