module fnet_CCFB_intake

! a = 0.00039682
! b = 0.45754

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/0.041004145502,0.115335028027,-0.063414767555,0.081421540362,0.162610854297,-0.018741180504,-0.045839241439,-0.055918661433,-0.105235415843,-0.180335615509,0.256082174193,-0.250130251792 &
            ,0.117396105986,0.762199758209,0.123109058825,0.056161208118,0.217526046228,0.033277848009,-0.289470320316,0.029436534007,-0.526417001384,-0.285665918367,-0.320830199894,-0.080126383994 &
            ,-0.049342354857,0.200823255843,0.050771868642,0.123403600381,0.353435723169,0.430059716513,0.087871130895,-0.081820887280,-0.137432290516,0.166649852713,0.247428052951,-0.395660217787 &
            ,-0.258953160711,0.574682057083,0.084702652930,0.252328315604,0.076623079322,0.552875580557,-0.175154881630,0.117670617620,-0.363451049054,-0.627173412747,-0.038963793792,0.066868074591 &
            ,-0.041646835826,0.760645764811,-0.112956269584,0.091677123566,0.067210426093,0.422528875458,-0.103564218572,0.072457484507,-0.128614316258,-0.494234620913,0.328613826046,-0.180571249119 &
            ,0.338230223869,1.276603076205,0.276294110326,-0.033624711298,0.058984208748,-0.562429106146,-0.157112333930,0.053942484221,0.374576057446,1.182465055736,-0.286591944776,-0.131591442574 &
            ,-0.026821383920,0.291234752830,-0.100687129574,0.110243668263,0.540059251604,1.106620867245,-0.173154440018,-0.014203718381,-0.004691143700,-0.099642670181,-0.022020077059,-0.012354045138 &
            ,0.063139363681,0.016002927060,0.000586542319,0.102537565205,-0.001577588658,-0.055659100156,0.040047699140,-0.042768315838,-0.024364902578,-0.025765676741,0.013483019978,-0.025222951936 &
            ,-0.004130219085,-0.079975125184,0.054181756846,-0.028210944739,0.063911228385,-0.108432819208,0.069516396916,0.034676681429,-0.046506591566,0.055314326052,0.088616117234,-0.109827037671 &
            ,-0.020358389543,-0.247132486272,0.060376334303,0.097626391966,-0.013550419280,-0.053238412452,0.070127501792,-0.014915887030,0.082935484770,-0.175811969367,0.069654855139,-0.010598071372 &
            ,-0.040640401737,0.319725863692,0.001338395621,-0.059014192871,0.053104026706,-7.837474625640,-0.011290334691,0.180880603266,-0.027181609069,0.041276017808,0.067291364212,-0.048349971110 &
            ,-0.100191391458,-8.013771882607,0.056875256060,-0.032950871251,0.129226654183,-0.236367599581,-0.040551174145,-0.049096924350,-0.397444609202,-8.104886563663,-0.092771338412,-0.186155966329 &
            ,0.363984035603,1.230112096058,0.196212980234,-0.314291199115,-1.391829781259,3.798748938741,-0.129252387470,-1.100366138552,0.590677512143,2.923340823508,-0.391408501861,-0.461808208477 &
            ,-1.211248425707,1.605660952721,-0.953463279383,0.228075210036,-1.880139007764,0.500937879769,1.702148194834,-0.370800884518,3.742769295436,5.884707613630,1.758868980675,0.687019004611 &
            ,0.961250536589,-1.293317163196,-0.346262245322,0.342850160205,-1.498747937223,1.089646244856,0.121137340082,-0.563192139340,0.625030912922,2.447337384109,-0.643661029893,0.993395029906 &
            ,0.694413766840,2.410737094980,-0.354746063209,-0.146010842287,-0.089667824246,1.608360345495,0.538266465974,0.116460415082,1.315278290848,2.528218570204,0.901011916117,0.498157441164 &
            ,0.764464474068,-1.207110765852,-0.238537068286,0.541668894691,-0.316202983925,0.419926059694,0.217278365118,-0.299216414271,1.251643009070,-2.827313385750,0.233448467815,0.362663289866 &
            ,1.181760085362,2.786481845887,0.951429906943,-0.330888176424,1.385896063650,-0.265195804035,0.432237862735,-1.103701091586,-1.344290094962,-0.375716031626,-0.152330046663,-0.042557932538 &
            ,0.897408511799,-0.098605093051,-0.215093858615,0.416917778302,-0.629632145080,-0.947676568752,0.347698976946,-0.447078741257,0.143193254120,-0.220094221911,0.073162164281,-0.052060788625 &
            ,0.231507932565,-0.159897679302,0.000389463405,-0.212044336890,0.269055127815,-0.044170723402,-0.119230282464,0.037455316444,-0.022724298208,-0.392217403863,-0.228178145069,-0.343049217829 &
            ,0.056717680018,0.080296388682,0.020592298890,0.019240004957,0.155269772104,0.192744549417,0.043373079403,-0.026758845695,0.402742318700,-0.070252329618,0.035076932969,-0.078855047443 &
            ,-0.276242717476,0.439502377898,0.022769934804,-0.413943414700,0.351693173744,0.198923540405,-0.011679813451,-0.045493985627,-0.038966346987,-0.802241438688,0.148031949420,-0.022713373010 &
            ,0.448747240990,0.410729105505,-0.132472220201,0.146717477529,-0.333345376251,-0.383802985034,0.315522967009,0.090038982943,0.137173692702,0.232914684910,-0.266834744659,-0.559870975782 &
            ,0.002813575593,0.633209817017,-0.870057470655,0.347502174566,-0.294598549187,-0.775517091826,0.567832280507,-0.229257555375,1.645466956535,-0.887264772646,0.574643816350,0.117083022833 &
            ,0.306226624025,0.042900924835,-0.985494327128,0.892712025222,0.125333114336,7.194337840304,-0.879434228779,-0.912527564076,-0.711991500057,0.931624136222,0.011983865003,1.003881235591 &
            ,1.738245630912,7.492695458726,0.829652782763,0.245829184292,-1.039802206437,0.088001927055,-0.735879336661,1.611642032845,2.706666067886,12.185976350990,0.032815024330,0.161944463566 &
            ,-0.881632860439,-0.421108172634,-0.585088446141,1.711021583562,3.783236620071,5.531928749684,-0.086533378028,-0.256906979469,-0.704070429792,-0.373927253224,0.159426480483,0.036467330606 &
            ,2.292213998893,5.047284977307,-0.301055326770,0.079564058647,0.039167042875,-1.548976387876,0.143989601187,-0.131256349733,1.421546396492,-4.586643319480,-0.583699201903,-0.588166591407 &
            ,0.898786145444,-1.509223369950,-0.213248923110,-0.925773870405,-1.988998679688,-0.145808566183,-1.461182948829,-1.137025653597,1.175250642347,-0.733611470110,0.805500024321,-1.286139411443 &
            ,-3.100393882266,-4.466767540054,0.110239340100,-1.030913703865,0.601153683441,1.676517021590,-0.484664593164,-0.645366656873,-6.519679402673,6.980682892777,-0.167211487640,0.272238464398 &
            ,0.716440923228,1.632366043727,-1.658676160437,0.984651997262,-4.900176469742,5.900876602229,-0.842354761152,-0.391869955985,-0.016052449355,0.226942691751,-0.187584239301,0.068289326034 &
            ,0.126251979105,0.446235177164,-0.194279885692,0.193577380706,-0.102792453809,0.454737606155,-0.009676567279,0.067584557293,-0.609468453913,0.474588526307,0.161476689910,0.101595066358 &
            ,-0.032003672099,0.140583284182,-0.011595515433,-0.026087128806,-0.292576505243,0.459142125311,0.073211549952,0.176790894067,-0.127264114774,0.628036934115,-0.158300741526,0.196682989125 &
            ,-0.257262368094,0.873154522469,0.016575428782,0.192854987376,0.039510845230,-0.072182377009,-0.013130821637,-0.082274245411,-0.548346191716,1.493675704243,0.011354451091,-0.002626792676 &
            ,0.012954465370,0.381826516951,-0.348915617605,-0.001712898916,-0.466921713543,-0.143931095037,-0.406877333849,0.266338849298,-0.140797862540,0.152489576869,0.109898076030,0.317794805265 &
            ,0.572349257696,0.325031722954,0.318388986192,-0.139038858593,-0.000753827338,0.285705937635,0.302460650631,-0.523938351295,-0.840918779545,1.006230919919,0.225210556804,0.314747132045 &
            ,0.498260168113,9.179662806295,-2.094417868699,1.541872597072,8.120310099840,1.305095304213,-3.156886337457,-0.222318604069,-0.514281046894,4.015371741064,0.865575412121,-1.655871961053 &
            ,-3.578196018931,3.261427108842,-0.065214840186,-0.056842242604,-3.129517089359,0.061999304524,-2.410513832530,1.114643530888,2.745791251055,13.629727744730,-4.238686342534,-1.219462718741 &
            ,2.209634072139,-9.057794093660,0.061850378253,0.733897284863,0.216526114478,-1.976417181655,0.670632313431,-1.438756700171,-6.212231278570,-1.625905789918,2.915631815881,0.306764473763 &
            ,-2.287157833195,-0.817991222101,5.488315549733,2.174737980024,-1.708046499671,5.199310483052,0.775183335629,-0.821044191353,0.557997781227,-0.305846918556,1.060269063964,2.052624156438 &
            ,-6.592788793812,2.661367234213,-1.825972012763,-0.715642007164,-0.567108910242,-4.567453034697,-3.044824375832,4.856769697153,-3.930785122664,-5.339780367221,1.273337474696,-3.444403138802 &
            ,-7.152718136058,-6.643210145807,0.969979431235,-3.013785647130,-8.537467703710,-2.639123049128,-0.813712204737,-1.321382000218,-2.968676113255,-6.643984708757,-1.766406625777,2.717925465831 &
            ,-11.285320646258,-3.773482965230,-1.009002872423,0.452967231395,-2.988187495241,-2.755162020384,0.217499340481,7.186428370526,0.346079769582,0.420523702614,0.131179373981,0.633955224443 &
            ,-0.483346560036,-0.411677678889,-0.539531753442,-1.356319792753,-0.049375754679,0.892585505655,-1.107356247169,0.000831973192,0.528572850713,-0.739673128432,0.479952499843,0.019769796270 &
            ,-0.706521766035,0.006442683121,0.700674277172,1.136275784792,-0.979455221631,-1.832139588372,-0.680606901094,1.470311614473,-2.934952114982,-0.704346222565,-1.979279523332,-0.086327360667 &
            ,-0.702864057559,-2.410555901934,0.280883859771,0.106425429462,-0.383949368706,-3.111324622110,0.670203511946,1.442329342977,1.889424372377,-2.945990100779,-2.952767517131,2.159172075669 &
            ,1.114903273783,-0.560986080846,-2.051243147229,-6.967263979915,7.359794632055,0.101511656802,1.847786811252,15.569726528277,-7.006520030697,4.367449438280,1.077855990194,-2.167276862610 &
            ,2.052225526901,0.032392950660,-2.348396391607,8.696989260543,3.163694505298,3.367263005858,-0.970394631018,-0.115528127350,-7.267126292386,-3.999408985543,-0.899183932747,-2.836038688194 &
            ,-1.032073338259,-4.371057225974,1.562956572450,-1.886470626934,-6.799701301855,0.596979182743,1.477535135017,-0.904994988139,-3.545082127601,-1.042271210709,-0.568225108313,0.785465351627 &
            ,1.132495466344,-0.702930331282,-0.183017274416,0.042363591510,-2.997092970957,1.764155910196,2.643155362636,-0.711272780450,3.060953038766,-0.624597180491,3.462287751776,2.217301794808 &
            ,-1.622900146111,-0.274247414014,-1.130784330952,1.441202132357,1.057070814685,0.309874268926,-0.856602070280,-2.549912383658,-6.000303354196,1.243646267990,-1.385747131155,-0.074660933910 &
            ,-0.204043934401,0.208052172820,-2.218738131475,1.056286467424,-15.069016722664,1.148584853687,-0.648702429895,0.926551004187,1.011523817589,-1.153279372343,-0.411382832669,-0.449140223058 &
            ,-19.176402546106,2.555908005166,-0.068700846721,0.696146637640,-0.424631054402,-0.628455749113,0.270626921939,-1.527678004658,-31.647298692725,7.518685835912,0.111168196211,0.140267352301 &
            ,2.279593283372,4.739685733601,-0.060552615164,0.663679600025,-30.361648450641,-1.890657493101,0.389697012194,0.003280044230,1.512295995674,3.098709971993,0.451735031354,-0.192977405111 &
            ,-8.326023013730,-2.323787533018,0.058554342403,0.393330137725,1.636957842664,1.431351828723,-0.126399808826,-1.578796654502,-0.190968145827,-1.496939659313,0.223139557815,-0.056455515409 &
            ,0.247338200864,0.093751707352,0.287918630064,-0.182587087922,0.512070519106,-0.670641164969,0.019440367271,-0.037463498263,0.649551565496,-0.058793283468,-0.291478955104,-0.462356623588 &
            ,-0.960160434067,-0.252537197619,0.008271240414,-0.298968265464,-0.039628325057,-0.060518835670,-0.111377802029,0.589130661375,0.589547690726,0.923146353725,0.229134083240,0.049312209989 &
            ,-0.047316031417,0.840197286946,0.250772632046,-0.645128765750,-0.192780678786,0.235664351511,0.049782339662,-0.009448422988,-0.107656750064,-0.266957824867,0.266742635827,-0.092177435084 &
            ,0.635349620929,0.687626079146,-0.230458888403,1.326533055986,-0.886715355826,1.295618367407,0.982796272910,-1.039104734339,-1.432418602837,-1.181279450766,-2.144575239588,4.113214762822 &
            ,4.436739072018,-0.587053042575,0.050183754178,0.382824072213,-0.718573786968,0.390184049342,-0.334930959464,0.624419017925,1.865763315026,-0.294864780821,0.096068338886,0.765624264292 &
            ,0.034379107266,0.076948062256,-0.182957246532,0.513447775803,0.477395917760,3.949950415643,0.201579634055,0.065200934498,0.110630877808,1.897097718438,-0.257008275948,-0.228380568749 &
            ,-0.102566953256,0.387236185613,-0.442251773248,0.645537983855,-0.234220344056,-0.618554867902,0.268656415867,-0.002411979014,1.331318845580,2.743673013341,0.316108065488,0.281870528193 &
            ,0.023421141584,2.023112545103,0.056696153678,-0.238467035217,-0.304578785624,1.151467046746,0.115432395117,0.635555519986,0.599894968329,0.941172888855,0.159911338683,-0.212972856691 &
            ,-0.582628302467,-0.181052687412,0.128598741497,0.010325343770,0.091947059917,-0.729731911751,0.860091317361,-0.653182545907,1.983160042485,1.092052716929,0.532425764751,0.719705952901 &
            ,1.006600219357,0.648833449216,-0.229367516385,0.266053835216,0.085686466501,0.586453386661,0.028850681313,0.411340106066,2.415500535711,-2.741356336276,-0.998943960944,1.373264712592 &
            ,-0.654875828075,-0.225282787600,-0.326067964326,-1.202617267729,2.358986623633,2.098563671652,0.061356151391,-0.329378550445,0.153556443445,-3.033877303649,-0.101327066247,0.336108323840 &
            ,0.993985354929,2.121644044751,0.188287544448,0.393285874605,0.423633143042,-0.559589334468,0.947067356379,0.459302534707,0.220916211684,0.039407815558,-0.126745471430,0.200324880328 &
            ,-0.192844304148,-0.461220498677,0.038124858939,-0.252769393675,0.069105842338,0.081733036961,-0.141591659233,0.221488820601,0.124008153513,-0.790331647869,0.011431493425,-0.088793796831 &
            ,0.140431144369,0.170433118784,-0.074353941879,0.138353284567,0.075540477392,-0.632676538529,-0.007617398263,-0.146599521449,0.071536725897,-0.088556701863,-0.143896789524,0.066742958836 &
            ,-0.155745447229,0.015860869226,-0.189814852463,-0.123470093692,-0.015130568177,0.020303189603,-0.223254206547,0.301110843639,-0.012948718552,-0.289324899669,-0.139093648716,-0.086685956994 &
            ,0.350262341201,0.002952603811,-0.182293505160,-0.058274225297,-0.651737285423,-1.526277321870,-0.179842621460,-0.115862937107,0.698909315981,-0.366322580898,0.534277565728,-0.641675097245 &
            ,-0.683977088947,1.047506720020,0.722080591603,-0.023649063813,0.614462538719,-0.930317276921,0.682503743582,-0.367021745750,0.140460603074,-0.536683856330,0.863921102745,-0.728526479582 &
            ,-0.118789196585,-0.499770671435,-0.078399828260,-0.112969343258,0.590097383721,0.356967916366,-0.452091153535,-0.079213752603,0.109828790577,-0.633543926263,-0.451539136950,0.178899288308 &
            ,1.008361274044,0.335867734778,-0.934511702602,-0.422315340946,0.067478890863,-0.295378618787,-0.376060729192,0.278504281600,0.327108190748,0.198572151978,-0.486730890914,-0.203820035404 &
            ,0.308541331950,-0.322314049761,-0.463797696030,0.435828268730,-0.291866076939,-1.672917481871,-0.329113216972,-0.391718713910,0.204268034336,-0.088543898029,-0.064406137239,0.182576984108 &
            ,0.155029898296,0.491613005862,-0.076519655412,-0.480025318096,0.142411295141,0.262424947015,-0.188094704152,0.153219332681,0.469191276675,0.842293883082,-0.201566610260,-0.025604679334 &
            ,-0.160265632054,0.544258522102,-0.043594020271,0.033088809455,0.394907328207,-0.676803022055,-0.116420520178,0.165226927513,-0.165516494586,-0.253721863891,0.069324947794,-0.210238766894 &
            ,-0.015249476016,1.133649549260,0.060487719106,0.247798455352,0.103468665069,-0.653814903696,-0.033225519538,-0.213807401480,-0.578264663562,-0.071930159784,-0.056329143798,-0.111723319349 &
            ,-0.347210647571,-0.713312553221,0.429612623178,-0.531492642304,-0.227602274513,0.108649224151,0.371852306351,0.265207214134,-0.068325131236,-0.033218862612,0.079713842172,-0.006962621825 &
            ,0.199355007357,0.026936288503,0.118569921789,0.060852750393,-0.006805516821,-0.086802688273,-0.044219127624,0.066686483947,0.017328379092,-0.191387290262,0.019328379506,0.014884203169 &
            ,-0.016624578177,-0.023949595649,0.018833948856,-0.024215717156,0.036941935242,-0.103198451086,0.022282788289,0.052179885068,-0.051538131753,-0.003359889859,0.038800463104,0.011994084050 &
            ,0.095952435584,0.000680482779,0.060598552711,0.035525019059,0.001827871975,-0.022413799809,0.018317871481,-0.000299796214,0.074424505485,-0.060775710818,0.013449434919,-0.006131715662 &
            ,0.008089816886,0.049627634262,0.034778125615,-0.029212157948,0.114563163969,-0.109092043302,0.025126986693,0.040296742718,-0.021789961677,0.198745267821,0.054576066974,-0.112712197617 &
            ,-0.010141929158,0.074235792447,0.065932279750,0.218042274000,0.037365740379,0.313612994090,0.183326167164,-0.293485183570,-0.188013011189,-0.176740131027,0.120862790712,0.186632929683 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-0.017962,4.5732 &
            ,2.0858,-0.58642,0.28272,10.8763 &
            ,-1.1791,6.6847 &
            ,1.6983,-0.53842 &
            ,-1.7423,-2.3226 &
            ,0.97009,-5.509 &
            ,-0.23332,3.5483 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-3.0955,9.4053/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/9.9295,-1.9484,2.4288,-1.7521,-2.714,-8.8654,0.2855,-0.89465/)
real, dimension(2) :: bias2 = &
  (/2.7998,-10.6693/)
real, dimension(1) :: bias3 = &
  (/3.5527/)
contains
subroutine fnet_CCFB_intake_initall()
end subroutine fnet_CCFB_intake_initall
subroutine fnet_CCFB_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_CCFB_intake_engine
end module fnet_CCFB_intake
