module fnet_Beldan

! a = 4.0132e-005
! b = 0.13616

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/-0.047564543905,0.105759967485,0.177345854006,-0.146065422437,-0.049750060203,0.198822182302,-0.105339619737,0.044591464446,-0.105806956768,-0.082827635049,-0.132369070503,0.079328075553 &
            ,0.162380090013,0.157642975783,0.138351749051,-0.045611391359,0.014024197858,0.128867237366,0.179989763224,-0.198950366485,-0.007162415630,0.051434327204,-0.077741405955,0.019274880147 &
            ,-0.236004122188,-0.076197958682,0.181295273391,-0.056101103752,-0.133014557992,0.311828758999,-0.102526990317,0.123143395319,0.107255148658,-0.094924044661,-0.611649618211,0.329294077431 &
            ,0.288738986505,-0.258832553896,0.288425693625,-0.208270130634,-0.111584105607,0.017028500896,0.106975513383,-0.085864074991,0.099386720795,0.275027886683,0.070392933670,-0.016214965846 &
            ,0.016318140696,0.167647032007,0.100659175484,-0.114198576624,-0.401963495421,0.118803510431,-0.299102318597,0.041064865030,-0.413377046843,-0.301729119260,-0.463946345816,0.221824302687 &
            ,0.380311916693,0.408113842769,0.434127570811,-0.128372065908,0.891988632016,0.618224904997,0.836739069917,-0.859152717074,-0.419906279224,-1.128080235268,-0.452700407589,0.062639271799 &
            ,0.000910390020,-0.315045633569,-0.962977385353,-0.172274254411,0.026734670107,-0.270944796007,0.466742049145,-0.345600150169,-0.251799255351,0.020445531869,0.026672987982,-0.465900999468 &
            ,-0.013242364577,0.280146333978,0.042734101060,-0.012437913198,-0.027563833253,0.016173599801,-0.020089010619,-0.438232161249,-0.008441327491,-0.048033706233,0.051183268751,-0.033740454830 &
            ,0.043457392126,0.070944517622,-0.084148726912,-0.609505579988,-0.056640105406,-0.024867319548,0.029516699070,-0.077194498882,0.061273805247,0.294565390752,-0.439685754571,-0.479044841535 &
            ,-0.289390274583,-0.141025626547,0.075794613810,-0.308415510320,0.070426034439,0.274027750454,-0.505557869048,-0.551002366824,-0.119374171977,-0.071638176292,0.108901349134,-0.266383046629 &
            ,0.351492212780,0.982275886347,-0.737538193345,-1.080235606292,-0.720796501982,-0.268739728899,-0.166466627508,-0.560382720067,0.074447578063,0.601247180393,-0.430413200497,-0.535551581170 &
            ,-0.582602540219,-0.094888245274,-0.082941106725,-0.363054286511,0.127247091900,-0.026876835401,0.130067359361,-0.096020179664,-0.357563692314,-0.195807033864,-0.180431928273,0.078337305757 &
            ,-0.255991166313,0.127537939086,-0.971625533725,0.417589869167,-0.294620975440,0.452812615936,0.094891512744,-0.404353254485,0.191071332210,-0.247739613114,0.194928208734,0.234218835875 &
            ,-0.314678430167,-0.204857637068,-0.321591290595,0.340146358945,2.343858720882,-0.534281929200,-1.631250420291,0.193983678030,0.848971011088,-4.471645070714,0.753467174664,-0.554037341356 &
            ,0.842704038299,-0.118780244880,0.972561191468,-0.747847170308,-0.016861924929,-1.285580791736,-0.308268970762,0.401391200826,0.301154886056,-0.743433461957,0.194703948400,-0.105783622412 &
            ,-0.525956546977,-0.548128591919,-0.489150215093,0.535360716306,1.462470222067,0.714399398168,1.392397505209,-1.562765834863,0.191250624638,-1.227394390013,-0.656055347410,0.333833432506 &
            ,0.486927677281,-0.184111848342,-0.619883477293,0.077925735019,0.527453837199,-0.438192059758,0.623033934827,-0.366015953319,-0.758152050780,-1.198064463116,-1.186955762032,0.084690969845 &
            ,1.767508811522,0.188313825343,0.996375399253,0.218092256832,-2.588726869640,-0.604751532796,0.502146823928,-1.293767624084,1.869855889392,3.993523951923,0.958479007913,0.325740015881 &
            ,-2.224578063500,-0.091396430931,-2.194209376701,1.512460219079,0.099249978096,4.054213264945,0.682775209363,-0.365650096501,-0.055043725782,-0.197767662797,-1.049956544117,0.672797300849 &
            ,0.214002759081,0.025404739443,0.518430232436,-0.420233807702,-0.069004179460,-0.074744179524,-0.358897289297,0.034833110299,0.151965818062,0.016891348679,0.131060621731,-0.076465520732 &
            ,0.189920534708,0.366941456716,-0.141483866399,0.058412434087,-0.353558895763,0.038388290039,-0.185681362676,-0.132797364567,0.170632718829,0.131170172924,-0.175879548292,0.101777842628 &
            ,-0.286029229757,-0.045538121200,-0.167489635032,-0.051252990048,-0.001662859795,-0.085851666618,0.418336576982,-0.196082128265,-0.198525492195,0.071820672802,-0.265747602123,0.252029969263 &
            ,-0.006947894377,-0.457866843115,0.206056072712,-0.306930606015,0.678311343681,-0.177687359556,0.322332627818,0.167939105913,0.159234821581,0.059258646165,-0.564246444580,0.443532530786 &
            ,-0.244627195212,-0.123887106923,0.028635972979,-0.213494276403,-0.393000104857,-0.144180237476,-0.477698959284,0.677387460981,-0.164451738170,0.427249481172,0.195936056561,-0.181587423539 &
            ,-1.613821028135,0.237805503183,2.137695442317,-1.006509012441,0.279958181084,3.016036737868,-0.439358379371,0.814137147019,-0.732373927242,-0.181073981779,1.200478143479,-0.588450557311 &
            ,-0.281204543348,1.283443532215,-0.496470973950,0.469871956180,-1.451241931262,-0.844876571064,-0.534740809072,0.350976760985,1.725051264285,1.889746461639,1.111410446935,-0.123505883442 &
            ,-0.370112541686,0.663769930365,2.809531726822,-1.345481688511,-1.857327175821,1.491943211110,-1.705846782213,0.957710967243,0.092025291102,-0.547109554231,-3.296078262455,1.815554588755 &
            ,1.883350567400,-0.504414013029,1.947098213076,-1.203667569298,2.029232294334,0.533661896322,-0.817355506995,1.019260554806,-1.329914899246,-3.297559210549,-0.256408155548,-0.517925055840 &
            ,0.922384216047,-0.031511396883,-2.067401018127,1.640402942622,0.538856064989,-2.196246056531,1.156112974081,-0.905516136305,1.059243612205,0.081709339442,-1.798545012543,1.509794830424 &
            ,-1.989182431731,-2.828767850099,-0.128851090292,-0.690389881621,1.020633246482,-0.318235467901,-1.696879007368,0.928632868059,0.811584394108,-2.917110164391,0.627206802727,-0.612336913298 &
            ,0.526179577074,1.938056773638,5.625394921156,-3.117169529688,-3.271581334362,0.063296083585,-3.734626077908,1.918835156029,0.253358740268,0.369934415537,0.611089842929,-0.434419928013 &
            ,-0.193962328083,-0.281722321317,-0.323092585790,0.121938379745,0.059797637479,-0.013578671964,-0.006070746045,0.146337896526,-0.222908914941,0.070303064164,-0.174285433187,0.060826114525 &
            ,0.117800894056,0.121114460065,0.372897755026,-0.345835687928,0.105876975236,-0.197646192256,-0.131478370545,0.127495761449,-0.058930920079,-0.403462910675,-0.785245037414,0.727441590362 &
            ,0.090841233615,-0.143914566626,0.297970430426,-0.160918572387,0.053498306323,0.466748454671,0.629325535943,-0.490793683490,-0.248965445464,0.094656798887,-0.430168210227,0.168759313020 &
            ,-0.153804380918,0.706620878898,1.404797404741,-1.003504914690,-0.361282102547,0.675165651265,-0.662567259763,0.354612097395,0.351980404235,-0.594456377010,-1.857774392541,1.310933223616 &
            ,0.271469002559,-1.074438045688,0.662683846199,-0.464801576684,-0.304563581911,-0.068093667037,-0.273612027237,-0.050491904623,0.377278915915,0.300606763047,0.290175129994,-0.131084303440 &
            ,-0.645164373382,-1.097101248110,-0.688534604963,0.280556412187,0.985770414976,-1.882768624315,1.213948516382,-0.088195050704,-0.887486960933,-0.092731896130,0.251871825180,1.444514414799 &
            ,-0.864540697978,1.248463382667,-0.572059164129,0.385120930682,-0.590895159113,-0.827237243567,-0.617630892067,-0.552200713470,0.384120376967,-0.084326113534,0.335398039338,-0.011978756076 &
            ,1.426031182219,0.582716599579,-1.184376661968,-0.071278412317,0.027451535388,-2.498821334574,0.165355166774,-0.864254000795,-0.644249544472,0.770260949744,2.330292808201,-2.068920656732 &
            ,1.292696069362,0.445934811290,0.104054965098,0.339645800000,-2.871102574664,0.847806066664,-2.012567662462,1.982472454592,-0.541489005240,1.305451417226,-0.167475663565,-0.568072628299 &
            ,-1.911070785025,1.266290219466,3.449369931741,-0.312522397963,-1.499559691321,-2.048874525881,-1.175751927267,0.690716365275,-5.830804181595,-2.895990608641,-0.793281602936,-0.584607718314 &
            ,-1.943335818205,6.437954064462,-2.089698155711,0.889411927757,-1.088728300357,2.132908440785,-0.024195157991,3.084586852120,-3.865056015588,9.038006284773,-3.036524401726,-1.123539975052 &
            ,3.755121696250,2.995712669318,3.502942682142,1.246129288601,-1.192547926149,2.317606191920,-1.205072173999,-1.903655952535,-2.417719795918,-1.277232042882,-0.417637970825,-1.823750965339 &
            ,-0.817520795648,-1.126358310709,1.182610171757,-2.136462690351,0.065569134441,0.553546911018,-0.095916257070,0.391924578240,2.104971170485,1.389591222024,0.337728239444,1.658203712456 &
            ,-0.622319605301,-1.148458679777,-0.179017344668,-0.405785501517,1.161373495622,1.404693748253,0.031456518000,-0.897294729154,-0.660708441348,-1.729793326217,-0.960546544661,-0.481893314419 &
            ,-0.647352932029,0.519279803889,0.596340810728,1.077005985221,-1.231963828548,-1.280401119671,0.583553584040,0.798829818815,-0.752679992152,-0.272736923761,-0.752807307132,-0.784340286732 &
            ,0.002781160888,-0.119469404926,-0.654292421004,1.448871055769,-0.745341682264,0.802069160777,-0.050688951352,1.694063615125,-0.844472866284,-0.806384563621,-1.014649787938,0.353537335023 &
            ,-1.082775961941,1.004629338948,1.079723927288,-2.596089712934,1.651178980231,2.786233902068,-0.644391662590,0.475992958604,1.857939981322,0.847489674390,-1.209946106801,0.811561008165 &
            ,-1.812753999714,-0.308097091389,0.123731928024,-0.925140929352,0.544556106174,4.841935280337,-0.314670083325,0.546028717282,-1.669636484168,0.156150999743,-0.176324299378,-0.586468901204 &
            ,0.176720368306,-0.398736446829,0.017867579850,-0.161529373943,-1.809100853574,0.296299018290,-0.352249322134,0.722111692840,0.250023078148,-3.377525027407,0.875480240434,-0.605811612586 &
            ,-0.909686819164,-0.888163254537,-0.620307817435,1.784993849374,-0.240705195881,-1.972731214184,0.096293733988,0.140950670923,-12.350561144902,-1.025209790124,-1.362491485724,2.506080739218 &
            ,-1.898073352889,5.889124535843,-0.179931472237,-0.021837385826,-13.008415362269,1.317115504709,1.869682139621,-0.378590704872,-1.837013097480,11.610482506131,-1.961903816157,0.151394515929 &
            ,-13.419783451688,-1.622926569832,2.178913444622,4.138481415467,-5.932456396424,10.854616465303,-4.747911089372,1.943123121939,-9.962880986860,-4.162720479706,0.006627336112,0.423438484359 &
            ,-6.671720133419,1.915509357665,-7.488526185288,1.463143793928,1.543511932468,4.223062984598,6.238261225553,-5.952078346469,1.519590146225,1.377582296834,-8.704568819689,-0.506761060828 &
            ,-0.649183247052,-5.936884186394,3.976862928915,-5.462547078089,5.955627904338,1.906393113805,-1.855024294014,-3.959264444650,-1.558781183745,-1.618174489605,2.357588886648,-1.073023262380 &
            ,4.727438466213,-0.931561434948,5.014950307616,-1.841158660292,0.335990847734,-1.278639325048,-0.140784598836,-1.301555510840,1.424070877675,-0.684862984230,0.053715393758,-0.159342139223 &
            ,-0.094408805119,-0.633522106350,0.233948475861,-1.329100637620,0.970819999469,-1.601611550312,1.383040910644,-1.220511882232,0.037776319037,-1.740786040571,-0.739387995844,-1.055928113261 &
            ,0.899589756645,-2.397036107673,1.440649036040,-0.905680720611,1.465383422437,-1.783093751485,0.437893453381,-0.199981111304,0.414394160882,-1.134616976728,-0.387131485145,0.425018044495 &
            ,0.113025249041,-1.301096468207,0.867603283695,-0.521290146513,1.095183037688,-0.510827031463,0.485786519522,0.201616820123,-0.091736912349,1.263814133271,1.015480586807,-3.045589113383 &
            ,1.447369226024,-0.924415497633,-0.864036096427,0.403692795039,1.327687066728,-1.698881321267,0.131495529410,2.347435334093,-1.560523744864,-2.369510866297,0.170805638621,0.360156710435 &
            ,0.034527469317,0.298370965683,0.176629315960,-0.263885866498,-0.049283486664,-0.049773988374,-0.091184943256,-0.070695658422,-0.343462321896,0.315359258337,0.691608984900,-0.189901342312 &
            ,-0.834373096259,0.667018850573,-0.506427298884,0.194556119101,1.566915806231,-0.326252603021,-0.177326294245,0.032034877438,0.163458867039,-2.265726936144,0.051554619458,0.024370156834 &
            ,-0.458861233696,0.116570812056,0.926959909591,-0.511525873868,-0.203032582995,0.840927353528,-0.329785465680,0.366944252001,0.369647844502,-0.126464621151,-1.063270678306,0.501987505326 &
            ,0.418426466117,0.027855874178,0.476972582894,-0.383474241208,0.866534478043,-0.408034302608,0.151125215752,0.307399183206,0.029872713318,-0.791703139601,0.007738094208,0.237149839874 &
            ,0.197883094080,0.004237190419,-0.895198915425,0.092954400158,0.549797115701,0.010851466720,0.551623245865,-0.386669758054,-0.397463420853,0.591019505644,1.756032512008,-1.353427433244 &
            ,0.351516611356,1.992801936616,-0.166671485403,0.461190710494,-0.799826883290,-0.363836435231,0.105438152030,0.450845167941,-0.118067037610,0.846865006864,0.445295991607,0.250577648856 &
            ,-0.139885478835,0.484166307319,0.795416520797,-0.072364859401,-0.694416801536,0.015306572427,-0.236032009278,0.476932878214,-0.036116289922,-0.087900177980,-0.388847760880,0.258307703188 &
            ,-0.269099466105,0.009020181551,-0.091350749207,-0.009280105298,0.013577489444,0.044101158805,-0.035019309267,0.003391498079,-0.225772643611,0.045210452417,-0.175335900170,0.057900614911 &
            ,0.024886896400,0.072635541672,-0.094949426589,-0.069580905136,0.034441372342,0.135264337474,-0.013202129098,-0.009356193060,-0.165332498271,0.248139920288,0.239079169523,-0.307478283082 &
            ,-0.068261265617,0.429213155809,-0.170365561943,0.074120877276,-0.107506877909,0.080607370580,0.041112308918,-0.027551473336,0.079210296388,0.287720965668,0.009343197319,0.017861762866 &
            ,0.080003177335,0.245186295876,0.111042017691,-0.104538088527,-0.192484566871,-0.063645854002,-0.157980936422,-0.003093217777,-0.112720898399,-0.088743270109,-0.051715105563,0.202474609013 &
            ,-0.005678032563,0.226161340479,0.048557893452,0.022451352429,-0.217592505192,-0.336233985414,0.008674014934,0.116539228672,0.370201289719,0.165660527203,0.217409993891,0.108396308871 &
            ,-0.068264329753,-0.060969321580,-0.001553741852,-0.108630360551,0.045342168587,0.074875885781,0.005523301515,0.010958267866,0.056988906593,-0.107538133758,-0.206437018596,0.047636867447 &
            ,0.321224788230,-0.064940940799,0.195191067614,-0.067442987041,0.057842929738,0.327749603017,0.531019045509,-0.021202935967,-0.595054801171,-0.421066856162,-0.300079789063,0.077288360904 &
            ,0.424538146999,0.299110141224,0.150287573949,0.025360742896,-0.397406414058,-0.831595380630,-0.202580575590,-0.045971783842,0.659253775580,0.146862161188,-0.315114856671,0.094752070153 &
            ,-0.117570169620,-1.186409080320,0.015873545328,-0.172097515450,-0.008213490468,-0.049258584420,0.133040712533,-0.178378621514,0.209297429895,0.173213560607,0.037249674336,0.059921022956 &
            ,0.642364094216,0.101255377524,-0.421629180189,0.132615905193,-0.054272327528,-1.219535501130,0.059513544925,-0.181899086822,0.147463162877,-0.005885928900,-0.613839335604,0.318407973660 &
            ,0.059030928703,-0.346510678932,0.240141791828,-0.262551974108,0.289080069541,0.270174989018,0.021622549533,0.122334546421,-0.416699671965,-0.293053119876,-0.153532984439,-0.106395666744 &
            ,0.235825419475,0.293815923487,0.383728818562,-0.021846109565,-0.436637528270,-0.098936647581,-0.290457982863,0.057299120066,-0.002440355583,0.010596168951,0.106547773918,-0.037956752389 &
            ,0.035946264876,0.046303443561,-0.001664863041,0.030329639877,0.006457988861,0.001069695133,-0.035442184295,0.011514268531,0.058180247139,-0.039092296801,0.049409955254,-0.022914259953 &
            ,-0.024570359033,0.015145601253,0.080358110534,-0.047533177216,0.008996912687,0.039213040272,-0.009998207952,0.021383240233,0.017550029095,0.018615848483,-0.022242515339,0.012070504702 &
            ,0.015382718113,-0.033957110178,0.017900878707,-0.017481076690,-0.058841183944,0.002740445608,-0.008919535161,0.044468599715,-0.027949538658,0.071467373030,0.004223888653,-0.001330511764 &
            ,-0.057613556459,0.010415084031,0.056589339779,-0.010335680621,-0.002999647411,0.096514700892,0.002081678516,0.010811357079,-0.042967150888,0.016112601113,0.059119628169,0.018715363541 &
            ,-0.081859163706,0.086688903927,-0.037773389297,0.015995411132,-0.057205659441,-0.009397389289,0.035805045976,0.097339617104,-0.145338914323,0.137376363128,-0.049892758439,0.013013379165 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/5.0451,-3.7462 &
            ,11.861,3.597,-3.0704,-5.5182 &
            ,-5.6583,-4.1356 &
            ,-4.1215,-1.819 &
            ,2.9519,-2.4883 &
            ,8.7966,1.5731 &
            ,15.6047,14.1443 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/1.1018,2.8162/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/4.2247,3.6293,0.41016,7.1559,2.4736,-0.060976,1.4589,0.26389/)
real, dimension(2) :: bias2 = &
  (/-13.2042,-1.4151/)
real, dimension(1) :: bias3 = &
  (/0.14625/)
contains
subroutine fnet_Beldan_initall()
end subroutine fnet_Beldan_initall
subroutine fnet_Beldan_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_Beldan_engine
end module fnet_Beldan
