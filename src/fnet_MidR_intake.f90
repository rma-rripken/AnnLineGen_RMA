module fnet_MidR_intake

! a = 0.00043839
! b = 0.49499

intrinsic Reshape
real, dimension(8,126) :: input = &
  Reshape((/1.236625933023,0.089606346390,-0.085243768026,-0.095132565012,-0.069017306963,-0.013661648115,-0.365887132982,-0.090566363063,-0.042627021865,-0.056755863689,-0.145528978688,0.063004564089 &
            ,0.059157010953,0.107897339210,1.097139476192,0.073473436021,-0.609382810973,0.020059361923,0.097160392328,0.138298809691,0.131951357057,-0.031297327703,-1.710486697136,-0.055937830448 &
            ,0.282043970163,0.116602819665,0.081659119648,-0.155561602889,-0.132769270258,-0.110652996901,1.562852517682,-0.108297359055,0.498373962481,-0.099257200807,-0.625200976070,-0.062030520723 &
            ,-0.024992894358,0.145170135603,2.082073854799,0.035026553058,-0.201954859638,0.067798229778,0.182442970235,0.263723158803,0.202820419401,-0.023490057338,-1.049316356904,0.008835832502 &
            ,0.764255673149,-0.142034278443,0.623094144311,0.010581980068,-0.014066100239,0.056789468244,-0.941006772912,0.138888963892,0.788051758263,-0.426629971317,-0.399596912299,-0.106566196184 &
            ,-0.027465168684,0.350563100739,2.591031569284,0.202964814191,-0.398081818849,0.351271671682,-0.637194029586,0.132591078542,0.067498472201,-0.218995283634,-0.952840018018,-0.162455835778 &
            ,-1.290916253088,0.280233182786,-0.014480301707,-0.370167106110,-0.363576879442,-0.255353750553,-0.304941956688,-0.173218247912,-0.612833355388,0.044449173882,-0.070598458403,-0.077986713330 &
            ,-0.073207167948,-0.034562430084,-0.090171931880,-0.047176649581,-5.036078816694,-0.001658385701,-0.051503609194,-0.008493105046,-0.017852299023,0.014648757277,-0.355604569475,0.035451383703 &
            ,-5.286513086255,0.019757288435,-0.009630673941,-0.005724229413,-0.013339827283,0.009942991534,-0.375626361527,0.023414668366,-5.267415156359,0.060862829206,-0.163299737658,-0.082769078539 &
            ,-0.088038996349,0.001258444118,0.038778445606,0.012301312511,-5.237814698761,-0.006746749042,0.032735515557,0.035178377195,0.031469261868,-0.018282662310,-0.185545134105,-0.009080988697 &
            ,-5.213303053423,-0.031613774652,-0.038719495364,-0.026545422445,-0.020732780521,0.043367054772,0.098366794714,0.037104237251,-5.184139695372,-0.015382535082,0.144484313358,0.033835553195 &
            ,0.022456155211,-0.029120954914,-0.209040510845,0.007800589216,-5.776526510946,-0.109334560232,0.163318882833,0.189151199071,0.170592376352,0.027119747392,-0.221058609784,0.049643468688 &
            ,11.534467988243,-1.609582167587,-1.756477461833,0.193260878247,0.176924709598,1.119352121648,9.432074973959,1.599593252961,-1.709863003038,0.118509549257,-0.950564560118,0.152136585801 &
            ,-0.062319050050,0.422519575437,-0.175480896954,0.607054061722,0.673300421715,-0.742966534328,-0.185004503442,0.142306444828,-0.222052671757,1.185061436548,0.063997809750,1.524100044251 &
            ,2.937271675581,-1.455629850145,-2.232883724342,1.901590299256,1.445190562386,0.127110429391,3.134942129406,1.662324848327,-3.354292630127,-0.932696836467,0.897732475830,0.282818237631 &
            ,0.096874689393,-0.165303783549,-1.406769315415,0.803021809081,4.194082600228,0.892502359537,0.386314374841,-0.621832713893,-0.577866293692,-0.759617884455,-3.453542106160,-0.734246471431 &
            ,4.979478272651,-0.030734752497,0.759148236688,0.828993863412,0.674095098582,-1.767324853896,1.337150655362,-0.670801963151,0.580375369867,-0.272668814792,-1.173262378792,-0.579119409869 &
            ,-0.441980883059,-1.082417269420,0.000212037274,-0.240993834326,5.455612617915,-0.043364843517,-2.030442775302,0.046640278469,0.258615445673,-0.825273592587,-2.152225319030,-0.781377023979 &
            ,-2.093635711930,0.715075933301,-0.658445495287,0.077241724342,0.268709556633,-2.171881400367,-5.463042910103,-1.976658285953,1.324955813781,-0.129799081091,1.529862669234,-0.105729429583 &
            ,-0.090989519822,-0.371561340456,-1.456023848204,-0.254118444897,0.166615016300,0.137548330081,0.479068611457,-0.154714933871,-0.175173207276,-0.257376545504,-0.572869191772,-0.198193759482 &
            ,0.566534696724,-0.096910459570,0.111381976851,-0.218573140733,-0.154428481131,-0.110324086510,0.295205009996,-0.152291881911,0.789441145077,0.110246958019,-0.116836134464,-0.067447877374 &
            ,-0.074273577705,-0.129262629611,0.086230140784,-0.121125627418,0.833017412789,0.204819750537,-0.618010473675,-0.234504573586,-0.213511439509,-0.266904158917,0.222877371541,-0.278188020020 &
            ,0.372525330828,0.159742893461,-0.092828256990,0.006626105536,-0.004812337488,-0.256283930509,-0.217410576284,-0.232656923596,-0.054374547883,0.135922443941,-0.516133646918,-0.395043294024 &
            ,-0.407130966639,0.053100762679,0.360977445765,0.012565320306,-0.301530487435,0.197828104888,-1.871908063218,-0.511482642806,-0.569045652264,0.025967011420,1.224656373037,0.115432371906 &
            ,1.484581356026,0.369794306212,4.259035625717,0.277341395043,0.455713838973,-0.971194555538,-4.591820935217,-1.316258768097,2.499074566313,1.563137741832,3.956925488629,-0.477330864677 &
            ,-0.279240455764,-1.147857140935,-5.084741082893,-2.038718154485,5.074161966970,0.881152892706,3.984695185226,-0.034690218463,0.275950418282,-0.442562618751,-1.654876673431,-1.654394529545 &
            ,4.074083741242,1.128508834906,1.828090625435,-0.534927081441,-0.640196631249,-0.014548643231,-6.762469769441,-0.389639663845,7.085037422636,-0.143353300856,-0.446756525387,0.049211271441 &
            ,0.022921119579,0.562104680134,1.557147398138,0.477900151113,5.010103280735,-0.835723487463,-4.776171702112,-0.098184739719,-0.469115565019,1.421080010508,1.436048808820,2.338426646384 &
            ,6.070037393610,-1.566213007951,-2.684778628970,0.808865068470,0.589254660926,1.010029358220,2.974737740203,2.030303127402,6.342349259041,-0.988076754398,-2.763863478688,0.194883728099 &
            ,-0.016308732983,0.443650615552,2.887168807077,1.558739614888,9.984571107800,1.025597570812,0.042301356544,1.315361509833,1.464128433868,-0.953983409540,2.351389084036,-1.622393393719 &
            ,7.356702984277,2.119101718947,2.377204262643,0.995483057014,0.955492573877,-1.476912874018,-9.820762973730,-2.218364767189,-0.381728012726,0.138802478679,0.270769654487,0.195040750357 &
            ,0.143325148401,-0.099970544409,-2.321218348844,-0.076147888406,0.619560304869,0.222147489540,-0.123727892451,-0.002559290392,0.028225688593,-0.101173484832,1.245578442232,-0.239892144548 &
            ,0.946063673811,0.316440553271,0.564392186859,0.068120670031,0.118154002628,-0.345816364379,-2.099341581299,-0.530571978537,0.256524917997,0.022481495290,-0.321247935785,-0.032635829768 &
            ,-0.002647474161,-0.047614081478,3.716938313834,-0.089734134543,0.576954352615,0.345766986022,0.683329712261,0.154371092938,0.166733668910,-0.248228372670,-2.889420824870,-0.408452469865 &
            ,0.224022867481,0.449038863258,0.517304613612,0.348297218657,0.334952802076,-0.243948295267,-5.223115005905,-0.447618706843,0.014802290841,-0.303850726738,-0.705775835788,-0.503985081957 &
            ,-0.466391271981,0.041332644037,7.266092314479,0.237775304107,0.468979950616,0.120650421901,0.637778492496,0.349528866991,0.368095347053,-0.139300752592,-2.437829173345,-0.296083031156 &
            ,-1.756240883967,1.533384081891,-25.809482001177,-4.211645178177,-3.826522907710,2.316256043141,5.408519064937,0.370414891332,-4.388334252323,5.367407272502,-14.975887758988,1.835468916051 &
            ,1.973877591874,-3.829372065725,5.967977140389,-5.201332123822,4.740637076830,0.275134167324,0.811121867762,1.504909453921,1.389498042397,-0.964226756582,-4.102623725855,-1.091492837288 &
            ,5.965542617188,-5.033518405313,4.300391983479,-0.321614582237,-0.582070592725,0.709583744974,3.693485850679,3.469956616746,0.553979158216,-5.297444688552,-2.623140592532,1.179358988598 &
            ,0.979966203397,6.564510380369,1.465464543499,4.819124689641,13.695964125306,-1.882068793246,-1.719841385815,-2.118291117874,-1.767551750633,5.516057499340,-7.362824489383,1.042702090688 &
            ,8.484850765463,0.383295321472,2.305966391869,1.176565775858,0.727746245543,2.067625269961,-9.564567145263,1.785557435068,0.505777778684,2.727088030896,-1.618328244818,-1.139592027938 &
            ,0.069930068487,7.238636858088,-0.651956577379,-4.158713572228,-7.751557104181,6.678326888716,2.064056542505,1.625896250218,1.010816254767,4.937656760814,-11.362213141182,-1.428305637414 &
            ,-1.675211677152,19.503733292995,-1.429133899507,2.080024377765,0.267078240742,0.659333388702,-5.447529066606,-2.950050210379,-2.029288661872,2.206235255587,-1.303313733451,-0.517997217129 &
            ,-0.294386463597,0.984023195703,0.423710413162,0.870217094474,1.389052657862,-0.219262895954,0.327622388710,0.269253292924,-0.722954770853,1.706609725289,-0.602711149379,1.509537851304 &
            ,1.855426699438,0.655548879157,0.785993836684,0.047251235164,0.822642121473,1.651911794722,1.610769387053,1.046987711500,1.428990476161,0.353391679884,0.549706004436,0.189582542135 &
            ,-0.535722464214,0.587462306002,-0.137111850237,-0.933323850746,2.825781543000,0.770915021800,0.324898319231,-1.914775344797,-0.364495482335,-1.761772429678,-2.422907699015,-1.798392294263 &
            ,0.995044543210,3.039613608868,-2.202858225642,-2.455352894681,-3.448164809611,-1.655753429899,1.576926530741,-0.100275916485,-2.255888951021,0.980208590547,-1.356377156692,2.279652130703 &
            ,2.355951476120,1.917010252612,4.678240574702,0.210362161134,-0.973269744272,-0.666567591218,4.308182743814,-0.809612432398,-0.819635640332,-1.430210470083,0.699719938803,-0.432360681143 &
            ,1.925156115808,0.405694102752,-1.509001156520,2.112115254725,2.276135758205,1.421256599664,-4.409781003037,-1.152519840085,-1.799362567129,-0.423792128607,2.056255997331,-0.587434266080 &
            ,-0.620089957654,2.939918894886,-2.657280128382,0.987139505804,2.126456992088,-2.084701975513,-0.720313195512,-1.254338752248,-1.392924883455,0.532082314178,11.576296703020,2.072470123989 &
            ,-3.243034748072,1.975839668676,-2.783663264067,1.226634068589,1.450424072899,4.703707159229,-0.072559907530,-2.340025679965,-5.216000502200,1.570060782028,4.217349564100,-0.395828709785 &
            ,-0.760829143335,6.600814076944,-4.148926396930,-0.899023116390,6.659501443227,-0.627925068945,1.304042412511,-0.415264003376,-0.480297412108,11.060959753399,0.476166296464,0.065545727173 &
            ,2.337704127887,-0.799414985633,0.415675614042,0.757132891414,0.367269332060,11.359713160539,7.496787376160,0.244486966027,-1.418510426035,-0.258294165255,1.030594129562,-1.435860155740 &
            ,-1.014189288924,26.511773267230,1.635661051342,0.522630641173,3.283028080917,-0.207427585861,-3.186365360776,1.534357045549,-0.058637100449,13.882570972231,2.964052156259,2.340256712685 &
            ,0.813908561317,-1.023274275748,2.211608091164,3.239804772511,0.254133089394,6.606286989808,-0.991725865835,5.792180201715,-0.124900263026,0.668885945590,0.996355133024,-0.161533901517 &
            ,-0.118757834527,-1.042399756403,-0.653612650014,-1.033481546727,-0.422003831099,0.067071159263,0.299572019691,0.317847651894,-0.105202235557,0.879544837750,0.063614859748,1.178396715348 &
            ,-0.088198350547,-0.246101357369,-0.342242988528,-0.198110900514,-0.112669679642,-0.448004914020,0.730818925324,-0.353617663895,-0.672521058888,0.026507524706,-0.685581820592,0.427577840499 &
            ,-0.191257252534,0.760957365961,0.754810556422,1.667136519511,0.434230142394,0.141844245807,-0.771366294592,-0.012853474554,0.201704474224,-0.671487408140,-0.946459548266,-0.910725107097 &
            ,-0.791384222323,0.321840027837,0.468861232166,0.037621442197,0.073514483914,-1.141178815243,1.648522497509,-0.996539686173,-0.986717805572,-0.252077361643,-0.132005988005,-0.279554920493 &
            ,-0.524876756335,1.738250738355,1.838822830379,1.963880446092,0.044934362163,0.607745441761,-1.145216362708,-0.251982646647,-0.379598259380,-0.236246371993,0.062543378271,-0.190626035309 &
            ,9.873151219796,-0.156075928903,0.816368932896,-0.248599292848,-0.293314318164,0.229968836932,2.586959179739,0.375365719915,-0.771302168594,0.575324022863,-1.182882527889,-0.052061082074 &
            ,-0.083100826823,-0.522705951146,-0.914454712201,-0.340148392707,-7.221518459773,0.156506085602,0.115474638929,-0.067470102897,-0.043345276099,-0.003730817302,-2.770398986144,-0.157887176169 &
            ,5.911658729639,-0.204566193853,-0.336272605581,0.260601742965,0.257151531383,-0.323923338996,-0.055210569638,0.051199902394,-0.957785059850,0.099823620711,-1.359544481633,-0.293044016581 &
            ,-0.242079250079,-0.702652578753,3.415428546174,-0.195637673939,-3.731954949550,0.725429029404,0.048469369460,-0.641067376694,-0.525504360766,-0.875018809757,0.576595431905,-0.556146008380 &
            ,0.218795423605,0.622647520643,-1.197050071049,0.456932006194,0.431967887950,-1.304789168960,-0.896343053648,-0.652857603149,-3.181456793243,-0.105397716331,-1.450216977955,0.300309360692 &
            ,0.136418293454,-1.594969884748,-5.991280559445,0.386807544212,1.517946427585,0.504450733204,2.081966845934,-0.364711155253,-0.212759488341,-2.259354398924,-0.913030351960,-1.217831514925 &
            ,0.394778604498,1.206875798864,0.970300650445,0.101229108141,0.143145221193,-3.273359276740,-0.808133460050,-2.603397656209,-0.291643580445,0.056590218890,0.245006921664,-0.146056234826 &
            ,-0.228178613840,-0.290684910979,-1.201535725647,-0.049269064682,0.159731119168,0.054071783880,0.266456341648,-0.190947343808,-0.182629703295,-0.217925206961,0.105442408380,-0.183485779179 &
            ,-0.759823125101,-0.016355307325,-0.292185873372,-0.017881409161,-0.014306750715,-0.071126792227,0.003708530330,-0.062738640512,0.251266028309,0.150023307046,-0.327059678217,0.099794992377 &
            ,0.076416748465,-0.255244311102,-0.663517170012,-0.234871003799,-0.394644761592,-0.072550112410,-0.012477002373,0.010481017268,0.018606845575,-0.055262720916,0.581722169492,-0.064032082662 &
            ,0.539668906641,-0.057213775123,-0.070552155219,0.370208776196,0.314083625400,0.003269705814,-0.837094209596,0.059473143283,-0.136007342005,-0.038620651987,0.321333738342,-0.289566731477 &
            ,-0.246610261751,-0.105350641689,-0.409163490334,-0.131326948943,-1.707516629038,-0.027105527566,-0.523156804202,-0.309655052076,-0.290294214082,-0.063944724388,-0.143025478332,0.014531669296 &
            ,0.908252156572,-0.103344768818,-0.398819764893,0.222586012739,0.223810504539,0.099673432360,-0.524511058001,0.026319595015,-0.931098305906,-0.187370100258,-0.063882309664,0.092394489376 &
            ,0.103798196306,0.080868430569,-1.203830209171,0.091250370860,-1.637992282122,-0.236136104628,0.578657695884,-0.088569787886,-0.092793696911,0.199167643129,-0.640523863355,0.256594210313 &
            ,-1.365400960256,-0.186072200935,0.263204407809,-0.120834939722,-0.100994338144,0.140247926919,-0.171395460186,0.162252150755,2.561987619270,-0.399533591574,1.186915797587,0.017590321776 &
            ,0.020815956224,0.124352453212,0.520939678567,0.216531060300,3.121154918297,0.096866586598,0.420681146240,-0.106366606390,-0.120898925336,-0.087578232282,0.155066671765,-0.042596575976 &
            ,-0.854918534737,0.327850093753,-0.166539021736,-0.435161914444,-0.404434563753,-0.144519146259,0.485449802721,-0.254076496482,-0.945200297988,0.194869107220,-0.311093515588,-0.410418024376 &
            ,-0.339663042189,-0.035289088147,0.956842905669,-0.280430649147,-4.229084165960,0.013925199221,0.284335654727,-0.530589479384,-0.456715579496,0.164541770724,1.054268996931,-0.146900988850 &
            ,-1.350158792810,0.168203680553,-0.393010740353,-0.804465979261,-0.772488705735,0.413441780488,-0.705898280818,0.023690586796,0.177247538467,0.053607610328,-0.610460329438,0.100814619061 &
            ,0.054865028606,0.073090302369,-0.284299795419,0.119552783749,-0.313507355974,0.006343134594,-0.118775582466,0.001708630901,-0.012598407441,0.043247659776,-0.126992334783,0.048907654625 &
            ,0.134733126500,-0.002511295620,-0.101829798559,0.046748265251,0.025264223194,0.069113916680,-0.325965328638,0.080513298388,0.254055699131,0.045501046452,-0.066150230765,-0.081408190463 &
            ,-0.078872407575,-0.022174204396,-0.156703362458,-0.031287742445,-0.057498326000,0.000340615963,0.071833900686,-0.019647158332,-0.021923017878,0.017968750891,-0.218145716613,0.014357675149 &
            ,0.094359183639,0.037569812122,0.050452965670,-0.029600538023,-0.027557901842,-0.003180739451,-0.109175687110,-0.018195264109,0.181626009387,0.040181649741,0.084918817381,-0.080774393002 &
            ,-0.073558947614,-0.043348893694,-0.149374726892,-0.048836087348,0.884899658812,0.105158479427,0.309028400025,-0.269687550691,-0.213273812322,-0.152562657524,0.206522906496,-0.246125677225 &
            /),(/8,126/))
real, dimension(2,8) :: hidden1 = &
  Reshape((/-8.0874,-1.8784 &
            ,3.4772,17.8154,1.446,1.8786 &
            ,17.2076,-2.2637 &
            ,-18.8701,2.5424 &
            ,7.8028,-0.06325 &
            ,17.1252,8.9561 &
            ,-8.6937,0.61721 &
            /),(/2,8/))
real, dimension(1,2) :: hidden2 = &
  Reshape((/-0.96735,7.1678/),(/1,2/))
real, dimension(8) :: bias1 = &
  (/-5.9004,-1.8296,3.6827,0.21588,1.682,-3.03,3.5922,3.4674/)
real, dimension(2) :: bias2 = &
  (/7.6929,-19.7322/)
real, dimension(1) :: bias3 = &
  (/1.4075/)
contains
subroutine fnet_MidR_intake_initall()
end subroutine fnet_MidR_intake_initall
subroutine fnet_MidR_intake_engine(inarray, outarray, init)
  intrinsic MatMul, Size
  real, dimension(:), intent(in) :: inarray
  real, dimension(:), intent(inout) :: outarray
  real, dimension(126) :: inarray2
  real (kind=8), dimension(8) :: layer1
  real (kind=8), dimension(2) :: layer2
  real (kind=8), dimension(1) :: layer3
  integer , intent(inout) :: init
  integer :: i, j
  do i = 1, 126
    inarray2(i) = inarray(127-i)
  end do
  layer1 = MatMul(input,inarray2)
  layer1 = layer1 + bias1
  do i = 1, Size(layer1,1)
    layer1(i) = 1.0 / (1.0 + DEXP(-1.0 * layer1(i)))
  end do
  layer2 = MatMul(hidden1,layer1)
  layer2 = layer2 + bias2
  do i = 1, Size(layer2,1)
    layer2(i) = 1.0 / (1.0 + DEXP(-1.0 * layer2(i)))
  end do
  layer3 = MatMul(hidden2,layer2)
  layer3 = layer3 + bias3
  outarray(1) = layer3(1)
end subroutine fnet_MidR_intake_engine
end module fnet_MidR_intake
